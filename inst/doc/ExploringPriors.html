<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Michael A. Spence, James A. Martindale and Michael J. Thomson" />

<meta name="date" content="2023-04-24" />

<title>Exploring priors</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Exploring priors</h1>
<h4 class="author">Michael A. Spence, James A. Martindale and Michael J.
Thomson</h4>
<h4 class="date">2023-04-24</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In this document we demonstrate the prior distributions and how to we
chose the default priors, based on the example of four species in the
North Sea.</p>
</div>
<div id="truth" class="section level1">
<h1>Truth</h1>
<div id="random-walk-parameter" class="section level2">
<h2>Random walk parameter</h2>
<p>The truth follows a multivariate random walk with covariance
parameter <span class="math inline">\(\Lambda_y\)</span>, <span class="math display">\[\begin{equation*}
\mathbf{y}_t\sim{}N(\mathbf{y}_{t-1},\Lambda_y).
\end{equation*}\]</span> In <code>EcoEnsemble</code>, the prior
distribution for this parameter is the inverse Wishart distribution. The
inverse Wishart distribution is descried by two parameters, the scale
matrix <span class="math inline">\(\Psi\)</span> and the degrees of
freedom <span class="math inline">\(\nu\)</span>. we were unsure of
correlations of the four species and therefore set the off diagonal
elements of <span class="math inline">\(\Psi\)</span> to zero.</p>
<p>To get an idea of the diagonal elements were examined the marginal
distribution of the diagonal elements of <span class="math inline">\(\Lambda_y\)</span>. To do this we explored a
univariate random walk, <span class="math display">\[\begin{equation*}
y_{t,i}\sim{}N(y_{t-1,i},\lambda^2).
\end{equation*}\]</span> If <span class="math inline">\(y_{0,i}=0\)</span>, then the distribution after
<span class="math inline">\(T\)</span> times is <span class="math display">\[\begin{equation*}
y_{T,i}\sim{}N(0,T\lambda^2).
\end{equation*}\]</span> The example in <code>EcoEnsemble</code> runs
for 33 years without any observations from single-species models, and we
can investigate what we believe the change in biomass is in 2050
relative to 2017, without any other information. To do this we will look
sample from an inverse Wishart distribution, using <code>rstan</code>,
with varying degrees of freedom.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>inv_wish_st_mod <span class="ot">&lt;-</span> <span class="fu">stan_model</span>(<span class="at">model_code=</span><span class="st">&quot;data {</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; N;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="st">  real nu;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="st">  matrix[N,N] mat_cov;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="st">  cov_matrix[N] Sigma;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="st">  Sigma ~ inv_wishart(nu, mat_cov);</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>)</span></code></pre></div>
<p>The lower the degrees of freedom, the less informative the prior.
However, this comes at the expense of computational efficiency and <span class="math inline">\(\nu &gt; d-1\)</span> is required. We therefore
want <span class="math inline">\(\nu\)</span> to be as large as possible
without excluding any plausible values. We look at 8 degrees of
freedom:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fit.iw <span class="ot">&lt;-</span> <span class="fu">sampling</span>(inv_wish_st_mod,<span class="at">data=</span><span class="fu">list</span>(<span class="at">N=</span><span class="dv">4</span>,<span class="at">nu=</span><span class="dv">2</span><span class="sc">*</span><span class="dv">4</span>,<span class="at">mat_cov=</span><span class="fu">diag</span>(<span class="dv">4</span>)))</span></code></pre></div>
<p>We look at the distribution of the first diagonal element</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ex.fit.iw <span class="ot">&lt;-</span> <span class="fu">extract</span>(fit.iw)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(ex.fit.iw<span class="sc">$</span>Sigma[,<span class="dv">1</span>,<span class="dv">1</span>]),<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="fu">expression</span>(lambda),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>which in 2050 leads to</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sd<span class="fl">.2050</span> <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">33</span><span class="sc">*</span>ex.fit.iw<span class="sc">$</span>Sigma[,<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">sqrt</span>(<span class="dv">33</span><span class="sc">*</span>ex.fit.iw<span class="sc">$</span>Sigma[,<span class="dv">1</span>,<span class="dv">1</span>])),<span class="at">main=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;standard deviation in 2050&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For example, this means that the SSB of cod in 2050, assuming in 2017
it is exactly the value from the assessment (<span class="citation">ICES
(2020)</span>), will be</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">20</span>,<span class="at">length.out=</span><span class="dv">1000</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">colMeans</span>(<span class="fu">sapply</span>(x, <span class="cf">function</span>(xs){<span class="fu">dnorm</span>(xs,<span class="fu">tail</span>(SSB_obs<span class="sc">$</span>Cod,<span class="at">n=</span><span class="dv">1</span>),sd<span class="fl">.2050</span>)})),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">axes=</span>F,<span class="at">ylab=</span><span class="st">&quot;density&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Cod in 2050 (1000 tonnes)&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>labsx <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">signif</span>(<span class="fu">exp</span>(<span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">20</span>,<span class="at">length.out=</span><span class="dv">7</span>)),<span class="dv">1</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="at">at=</span>labsx,<span class="at">labels=</span><span class="fu">c</span>(<span class="fu">exp</span>(labsx)<span class="sc">/</span><span class="dv">1000</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">tail</span>(SSB_obs<span class="sc">$</span>Cod,<span class="at">n=</span><span class="dv">1</span>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">range</span>(SSB_obs<span class="sc">$</span>Cod),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The solid vertical line is the assessment’s SSB in 2017, with the
dashed lines being the maximum and minimum SSB values from 1984 until
2017. Therefore we used the fairly uninformative prior <span class="math display">\[\begin{equation}
\lambda_y\sim\text{inv-Wishart}(I,8).
\end{equation}\]</span></p>
</div>
<div id="initial-distribution-of-ssb" class="section level2">
<h2>Initial distribution of SSB</h2>
<p>We also require a prior on the distribution of SSB in 1983, that is
<span class="math display">\[\begin{equation}
\mathbf{y}_{0}\sim{}N(0,1000).
\end{equation}\]</span></p>
</div>
</div>
<div id="individual-discrepancies" class="section level1">
<h1>Individual discrepancies</h1>
<div id="long-term-individual-discrepancy" class="section level2">
<h2>Long-term Individual discrepancy</h2>
<p>The long-term individual discrepancy for the <span class="math inline">\(k\)</span>th model is <span class="math display">\[\begin{equation*}
\mathbf{\gamma}_k\sim{}N(0,C_{\gamma})
\end{equation*}\]</span> with <span class="math display">\[\begin{equation*}
C_{\gamma} = \Pi_{\gamma}  P_{\gamma} \Pi_{\gamma},
\end{equation*}\]</span> where <span class="math inline">\(P_{\gamma}\)</span> is a correlation matrix and
<span class="math inline">\(\Pi_{\gamma}=\text{diag}(\pi_{\gamma,1},\ldots,\pi_{\gamma,4})\)</span>.
We put a uniform distribution on all correlation matrices, <span class="math display">\[\begin{equation*}
P_{\gamma} \sim{}LKJ(1),
\end{equation*}\]</span> and <span class="math display">\[\begin{equation*}
\pi_{\gamma,i}^2 \sim{}\text{gamma}(1,1).
\end{equation*}\]</span> This prior gives more weight around zero but
has an expectation of 1.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.001</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs,<span class="fu">dgamma</span>(xs,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">xlab=</span><span class="fu">expression</span>(pi[gamma,i]<span class="sc">^</span><span class="dv">2</span>),<span class="at">ylab=</span><span class="st">&quot;density&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAh1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZrY6kNtmAABmADpmAGZmOpBmZrZmkLZmkNtmtv+QOgCQZgCQZpCQkLaQkNuQ2/+2ZgC2Zjq2Zma2kGa2kJC2ttu22/+2///bkDrbkJDbtmbb/9vb////tmb/25D//7b//9v///+ENi9EAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHjElEQVR4nO2daXviNhRGSQvpZqZrOm3c3W2xwf//99ULISlBeqUryboy7/nQZ6YxunBytWvEpidWNrnfgHYoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgsqBNMeQSFLe4dFAQgIIACwu6qtruNTwbmTOIgkBxFASKoyBQnP5GKHcvRkGgOAoCxamvY7kFqU8hCgLkF6TcUCJB9WazOz0NM4ofYHF3KajZHgZHu74/7itU3D0KOj1Vfd8+PPezKntxyutYEkHH/VCz2k/+6l/+ay3uDgV5ZdA9CnptgyZVoDjddSx/L6Y8hbKPg+IXHRcNglQbSi2owb3YfQu6LuXmfpzmZlpFFdOcQhQESCRo6uIHDC3QO0F6DSUaKG6q+Q/tyx9AcXcm6M342WGqMf1VraF0k9UZh8mqd/GL4i/ouB8nWVb8M2hNgsYWZmNqWi5PnFPItQ3SW8eEVQw5GtJswpA/N+KuTNCsyNiJC+JqTSGZoHZayDg9GRNEEHc9gsbqM5sxdVGiuKsRdNxPa6nx4+o0JBD0YfYTkD63465NkGmlRxxXZzPtK6h+XdGpYsddhaDXDIofV2UK6VgPShMjCroEKTTkKei4r15mESHjaFPc8gUFh7P/IxqFKaSqimlMIdFUoxqnqvJ5mCWuvhQSCKq3h+5x19do2UwUdwWCxvXUdpjLR59qzP9fmyGZoHqQE32q4fmGFkJSxXbH/fZw3CepYupSSLYe9PB8egryY4mrzJCybj5BpEA0ClJlSCAI7ruHxi1dUO1spns0HVG0C9JkSNLNV+jZy3zWnGfWuJoMycZBiPOGqjCDVFUyf0FOHfw4UgoRpMeQoA1qjYef31I/PMsFKUoh0ekOp16s2VRyQXoMJRwHdY+fBgjSYijlQHEYMIkFqTEkETRUsu2hrhLHLVdQ+/DcjLP5yuVlTiftbz+hw5Ckm6+mg3Wi9SCfm690GJINFEdBaVYU//eMBkPyDKqDVu2d4pYp6NwGNdbhoudJe9NDCgwJe7HNxnqKyvukvSlofkNJxkGCc9KmqNkNJREkOGlvDJvbkPfhBbjS08fMoPyGRLP5qn/5Z/EG/E/aWwLnNSRfDzLlxoT/SXtL5KyG5CuK6QeKl2dzGpINFEcWGCheHs5oSLyi2IQdJ/f7yBkNiQeKYceDfGcR+Qwp3Fm9/XwuQ6UIymaoGEG5DJUjqPe4Xz4iBQnKk0RFCcqRRAsL8v82hncFRHkfHgGjP5i4uKWTqDhBSydRgYKWTaISBS2qqExBCyoqVdBiisoVtJCikgUtoqhsQfPIM1JRhgDRH1y8uLSOEgmKszfvTEJHaQTF2pv3IJUj5XvzXoRMgs2FRn+wj7o370t0SWvKoEvZQQsq14VFf3Ak5t68lEiaEvViMffmgwhcn1vFOMgpnHgp804EvQl8BXzeuWDZ+5EfJF+Ga1/v3JW2aL84d1fFfKEgwDomqwnJNlkthhSCHKYaboWCn4f9OPTlAY87TFbdCl2rIGYQAk9W3QpdrSA8WXUrdL2CIhVKQWE/pyAKCvv5+gWtCQoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASIL6gFlxD1ffe5ecV/2nmrzK9tYOm2qxHmFVGvS9ejCxpvR7HekDK8S9sFM8NLG/NHGA9N2EsffkFmQd1n3tcmxBY073zYvpyjtd3AM9+CaryJb7rE0H4t73QbpDG2/8UksQWBTzhtiMC3ac8Ru6Bm+6NZUOP/lQbRBU1JbFcABdkvR7deLzLEt7RB9Rf2Fu4GsQXNv3x7CiBB1l231voJxxpuFjRfh+13G6tCQS3oZmxflOtyE6RfQ6SvioFd296mf4qOBFmuw77B4o10DwQ1uI0wf8LmfLbFasCvr1++m7cLst8EOqsBdcScQU4vvyLDQNH2DrvHylr6+OHfHDIxPmP60fiLy9tIu0wGLILOdcRcQI0qkL0Ncnj5FZysAigIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCgDEHjdmLYdyyLKUNQsxsc+S1TxKIMQSNNlSVsMYKOX4d8W4OcUgQdPwR9GYGcQgQJTh1EogxBtgMziSlD0LjW7rmnHosyBGWEggCqBf3zCHbJFkCzoO67fz8eco1/XtAsaJiDDYK+Cfu2oVB0Czp+23dfUpCZ7isKstJWFGRjXOIYBtF/52ymVQuazsn8kmkIfUa1oAv19jA0R1koQtDpp+7PJs+CYhmChv7+j4+Z2upCBJ1++zlT5EIE9b/m6slKEfR7rtFQIYK673NFLkTQMKTORCGC8kFBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQH+A1hgrypRhDqXAAAAAElFTkSuQmCC" /><!-- --></p>
<p>The difference between two simulators, <span class="math display">\[\begin{equation*}
\gamma_{k,i} - \gamma_{l,i} \sim{}N(0,2\pi_{\gamma,i}^2),
\end{equation*}\]</span> for <span class="math inline">\(k\neq{}l\)</span>. The standard deviation of the
difference of two models is</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pis <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="fl">1e5</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pis)),<span class="at">xlab=</span><span class="st">&quot;Standard deviation&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmZmZmtrZmtv+QOgCQZgCQkGaQ27aQ2/+2ZgC225C2/7a2//++vr7bkDrb2//b/7bb////tmb/25D//7b//9v////FOwbWAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAI/klEQVR4nO2diXajNhiFyeIu9rSTTkM7pQ12eP+HrBbwkli6aPmFYO53TnJsAxL6rAXED24G4qVZegdqh4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAYYLax+/Dcdc0D69Cu1MfQYKMn5+UnNPhq9QO1UaIoNNhryQ965fd05vQDtVGmKCvw/vLXr/sVV26m9xqkBBkak/nrUGr6fNlBJ0Oj99NFepdvfQPLkiZsfXzOVNyyyElKE9y83sAMWoWpHvIxRVJC+pco9jcLAPGEREK16Cg0bOZtsmSdSQVN7HzKosaWoOgRQ0JCXp/sQ3J0QPNSa5xvC6MjKCu2dsX/fQiPLnG+aYoIoLG8zBN9KnG7QrLNTIRQVeTHM6T1cD8tiUofw1argpJ9UFjFYrugz4t35Yg1cjsKOacLgPJ3akwCxmq9DjozuKFGlmdgu4upSCwlILQ0kUMVSnIsXCRXmhNghapQlXOBzkXLmBoVTWIguCy8oYoCEBBgAoFxXVPUlAQIFyQOlF3XlDOku/aBenZnsY1zZMj3/ULGjI4cucbPhEiSnQf1Pku6qTkuwlBOrhFB5HFx9dtWZCeTrVmXJcsUvINnc2XJmYUyxHbu2VBX6yfhOrjy3c7glyRP4n54h0qayhUUHuZ0ZEZ5tcu6FKD4rJDE2Yz9qd2QbL5zsmmqCEKypWZXfF02E9XlVOOoxMFlTRUWQ2alwsFxW0sQtSpxl6fqqbd55QkqKShCEHt09tx9zzeD+aj99xxuGFBOr6uV+fy3lMNdTy5P/765r7j8H6+SzX4HDndCNK3XPpONVQlG1pTe8JC8DYhSLWt0+Hp7XRwNzFTb8w9q4FBnNsQpA6EHl7fXzxdkLlndXj/dwisQQHFLmZI5js7Nz+ram5yP46gobPDV9+47gpPFVTMUIQgeB9GdL4bEdQmmfHlGySokKGYYT5kpizojsOgMlcsKOFpE94Js7AiVyvIO8An5RsoqIyhiD7IPTQl5htY4loFzZowi7rjMFRQEUNCB4oxdxwGl3e9guLuFwsXVMJQjCDVyJ7eWs9gH3fHYXhxKxXUP7x2+mzebahQDSpShWKG+b0ptm8+KOqOw4jSVilItx8tyDujGHHHYUxhqxQ01aA2adY+j6AChqL7oC7tcHHLgmz7SYyiyiVI3FA9Fw7jMvhxBEWmX6EgO0ClPj8ylyBxQ8GCWts5d4mx9psVdH4w4nEXM4q5J8yiCypsKFDQ1WwZvjYflO9GBF2dgWWOct2MIHieHplvfDllDW1BkKihWgSlFJKCQhPLSbCgy0BdjyBJQ7WcaiQKkjO0DUGCVagSQcmpixnajCApQ1sRJFaFtiNIyNBmBElVoe0IEjJUh6Asics0ssKCHBNmuRLPksyHRLOvGJNcpsQpKCzVskmuQpCAoY0Jyt8PVSEoZ9q5DQkJCgvizFqmzIZkBAUGcWYuUl7f2VccwkPwFus3cqYVkmlgEGf2oSfnL0rVUIMkjl7KHzgE9kEhQZwy51CZHAmNYkFBnFITFVkUVXAcJDjhnsHRpgUN4/RBUgLZV7wF33Eo6sfmMP9XA+9snH1FfyoT/6yGsoKkkpOjgj6obqo4Wa2ZKk5Wa2axU43VICEoLMzKm7JvYfSG8alm2m5GDZqb8jYFzThZnZvyRgXhk9W5KW9VULaUKYiC0lKmIApKS5mCNgMFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCCAny/faG4viz46KIuTLpnO/uwBOyXM9fszPFcQ8lkRGkHybTu8tyOjiuGr2/qI06V1F0SIknVfWtOATZX3KIQ0SQvT7kfI5M77x2bR/O44itMU9g8TzV2TxJ9H6GIr8cm4C3nPqakX+PfbXEI6h7+sMhqEt45I+MIO+Pk/gXDf6n63dOeSpTVx/U/uLr2fyICLJVwFMRvII8VyV7dzl1s3YI0r84oyzFGapPUO8dbpy/swyfIhrZEVXXxNBVbYd2k6VXUNzT2ZbopAefIPgYPkc5uzGqxS0hcqxfYpj3CPI9Staq8bUURw3CG3pY5EDRubPHna/+6PJfheDcX+Hu5/qrqqmThicFLkFjQ3Ft2nrbkKcPQht64MkqgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAQoIchE4Zqr8b3zArkj1OHm4zvrXD1vxSZ/+0EGCgjqTdxAq0rn2ftIQTdkl6MpIMjGCenwVAq6xyVw97gzj0UZY1FOh98PNihFx8p804Wflnz5plvk+ePhep3OBKyOMVEPfxondjuT/H/mg95GtV6yiKdIE5sMma9YV6jOtDcdVa/+dNRvr2OCLktMVOr0seb8Ri8/7vbWemt9XLYb+yDdqE+H50sWCZTopPVXa/poU4IvrzYozgTOqxe2Mqgu6tMS+7FNYVrH/N5p//hdB0CqNx9StH82Cq0f144M3pwoNMy/vzRXnXTfNON3rf7ZaLOxf7ksuf14emPfqzLrdYyCDynqP6tkXCm1Zyp3HKRaidlX1Yk8/rW7COrOJm6WdNeCzm/6czCralft09unFC+C1Kt1CJqq+Ph9m7fH3Z0adLvEV4PsR39f+zh+ErSaGjSNYr2tQaas/VUTG4OqVeFvlpw/1tue31xKezr8ZrqhDyl+6IPWIGi8jUtH0OtO037V5s2491qCHqFul5w/Nmmc3xhjrT0meB7OFWbcbv9xFFuFIHuqYUraKlcmQri9/nqnY5ybJYPnOMg2uOZ6e72dTv7DcdA6BK0aCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgI8D9S4wJSr3LVTAAAAABJRU5ErkJggg==" /><!-- --></p>
<p>and the distribution of the absolute difference is</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="at">length.out=</span><span class="dv">1000</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs,<span class="dv">2</span><span class="sc">*</span><span class="fu">colMeans</span>(<span class="fu">sapply</span>(xs, <span class="cf">function</span>(x){<span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pis))})),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">axes=</span>T,<span class="at">ylab=</span><span class="st">&quot;density&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Difference of two models&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We do not expect the models to differ by much than one order of
magnitude and therefore we used this prior.</p>
</div>
<div id="short-term-individual-discrepancy" class="section level2">
<h2>Short-term Individual discrepancy</h2>
<p>The short-term individual discrepancy for the <span class="math inline">\(k\)</span>th model follows an auto-regressive
process, <span class="math display">\[\begin{equation*}
\mathbf{z}_{k}^{(t)}\sim{}N(R_{k}\mathbf{z}_{k}^{(t-1)},\Lambda_{k})
\end{equation*}\]</span> with <span class="math inline">\(R_{k}=\text{diag}(r_{k,1},\ldots,r_{k,4})\)</span>
<span class="math display">\[\begin{equation*}
\Lambda_{k} = \Pi_{k}  P_{k} \Pi_{k},
\end{equation*}\]</span> where <span class="math inline">\(P_{k}\)</span> is a correlation matrix and <span class="math inline">\(\Pi_{k}=\text{diag}(\pi_{k,1},\ldots,\pi_{k,4})\)</span>.</p>
<p>The distribution was <span class="math display">\[\begin{equation}
    f(P_k | \alpha, \beta) \propto \begin{cases}
    \prod_{i = 1}^{N-1}\prod_{j = i+ 1}^{N}
\frac{1}{\mathrm{B}(\alpha_{\rho,i,j}, \beta_{\rho,i, j})}
s(P_{k,i,j})^{\alpha_{\rho,i, j} - 1}\left(1-s(P_{k,i,
j})\right)^{\beta_{\rho,i, j} - 1}&amp;\text{if }P\text{ is positive
definite}\\
    0 &amp;\text{otherwise}.
    \end{cases}
\end{equation}\]</span> with <span class="math display">\[\begin{equation}
    s(\rho)=\frac{\rho+1}{2},
\end{equation}\]</span> and hyperpriors <span class="math display">\[\begin{equation}
    \alpha_{\rho,i,j}\sim{}\text{gamma}(0.1,0.1)
\end{equation}\]</span> and <span class="math display">\[\begin{equation}
    \beta_{\rho,i,j}\sim{}\text{gamma}(0.1,0.1).
\end{equation}\]</span> Sampling from this prior</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cor_pri_st <span class="ot">&lt;-</span> <span class="fu">stan_model</span>(<span class="at">model_code =</span> <span class="st">&quot; functions{</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="st">  real priors_cor_hierarchical_beta(matrix ind_st_cor, int N, matrix M){</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="st">    real log_prior = 0;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:(N-1)){</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="st">      for (j in (i+1):N){</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="st">        log_prior += beta_lpdf(0.5*(ind_st_cor[i, j] + 1)| M[i, j], M[j, i] );</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="st">    return log_prior;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="st">}  </span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[4] cor_p;</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="st">  matrix &lt;lower=0&gt;[5,5] beta_pars;</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="st">  corr_matrix[5] rho[4];</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="st">  for (i in 1:4){</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="st">    for (j in (i+1):5){</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="st">      beta_pars[i,j] ~ gamma(cor_p[1],cor_p[2]);</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="st">      beta_pars[j,i] ~ gamma(cor_p[3],cor_p[4]);</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="st">  for(i in 1:4){</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="st">    target += priors_cor_hierarchical_beta(rho[i],5,beta_pars);</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="st">    diagonal(beta_pars) ~ std_normal();</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>fit_cor <span class="ot">&lt;-</span> <span class="fu">sampling</span>(cor_pri_st,<span class="at">data=</span><span class="fu">list</span>(<span class="at">cor_p=</span><span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)),<span class="at">chains=</span><span class="dv">4</span>)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>ex.fit <span class="ot">&lt;-</span> <span class="fu">extract</span>(fit_cor)</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>def.par <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly=</span><span class="cn">TRUE</span>) <span class="co">#Old pars to reset afterwards</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(ex.fit<span class="sc">$</span>beta_pars[,<span class="dv">1</span>,<span class="dv">2</span>]),<span class="at">xlab=</span><span class="fu">expression</span>(alpha[rho]),<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">log</span>(ex.fit<span class="sc">$</span>beta_pars[,<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">/</span>ex.fit<span class="sc">$</span>beta_pars[,<span class="dv">2</span>,<span class="dv">1</span>])),<span class="at">main=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Expected log odds&quot;</span>)</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(ex.fit<span class="sc">$</span>rho[,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>]),<span class="at">xlab=</span><span class="fu">expression</span>(rho),<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xs,<span class="fu">dbeta</span>((xs<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">apply</span>(ex.fit<span class="sc">$</span>rho[,,<span class="dv">1</span>,<span class="dv">2</span>],<span class="dv">1</span>,var)),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.35</span>),<span class="at">main=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">var</span>(rho)))</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(def.par)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The above plot shows the different aspects of the emergent
distribution of this prior. The top left plot shows the marginal
distribution of parameter of the beta distribution with the top right
shows the log odds of the expectation of the beta distribution. The
bottom left plot shows the marginal distribution of <span class="math inline">\(\rho_{k,i,i}\)</span>, with the red curve being
the distribution that gives a uniform distribution over all correlation
matrices. We gave slightly more weight to correlation matrices that are
less correlated. The bottom right plot shows the variance of <span class="math inline">\(\rho_{k,i,i}\)</span> over <span class="math inline">\(k\)</span>. The variance of a uniform distribution
between -1 and 1 is <span class="math inline">\(1/3\)</span> and the
variance of the marginal distribution of uniform correlation parameters
is <span class="math inline">\(1/5\)</span>. We allowed the prior to be
fairly uninformative over this space, as we were unsure how <span class="math inline">\(\rho_{k,i,i}\)</span> and <span class="math inline">\(\rho_{l,i,i}\)</span> related to one another,
however, we do believe they may be similar and therefore we increased
our beliefs around 0.</p>
<p>The <span class="math inline">\(i\)</span>th diagonal element of
<span class="math inline">\(\Pi_k\)</span>, <span class="math inline">\(\pi_{k,i}\)</span>, was <span class="math display">\[\begin{equation}
    \ln(\pi_{k,i}^2)\sim{}N(\mu_{\pi,i},\sigma_{\pi,i}^2),
\end{equation}\]</span> with zeros on the off diagonals. The hyperpriors
were <span class="math display">\[\begin{equation}
    \mu_{\pi,i}\sim{}N(-3,1^2)
\end{equation}\]</span> and <span class="math display">\[\begin{equation}
    \sigma_{\pi,i}^2\sim{}\text{inv-gamma}(8,4).
\end{equation}\]</span> Sampling from this leads to</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>st_mod1 <span class="ot">&lt;-</span> <span class="fu">stan_model</span>(<span class="at">model_code =</span> <span class="st">&quot;data {</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[4] gam_p;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="st">  vector [5] log_sha_st_var[4];</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[5] gamma_mean;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt; [5] gamma_var;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="st">  gamma_mean ~ normal(gam_p[1],gam_p[2]);</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="st">  gamma_var ~ inv_gamma(gam_p[3],gam_p[4]);</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="st">  for (i in 1:4){</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="st">    log_sha_st_var[i] ~ normal(gamma_mean,sqrt(gamma_var));</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities{</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[5] sha_st_var[4];</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="st">  for (i in 1:4){</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="st">    sha_st_var[i] = exp(log_sha_st_var[i]);</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>test.fit_norm <span class="ot">&lt;-</span> <span class="fu">sampling</span>(st_mod1,<span class="at">data=</span><span class="fu">list</span>(<span class="at">gam_p=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">4</span>)),<span class="at">chains=</span><span class="dv">4</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>ex.fit <span class="ot">&lt;-</span> <span class="fu">extract</span>(test.fit_norm)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>def.par <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly=</span><span class="cn">TRUE</span>) <span class="co">#old pars</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(ex.fit<span class="sc">$</span>gamma_mean[,<span class="dv">1</span>]),<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="fu">expression</span>(mu[pi]))</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(ex.fit<span class="sc">$</span>gamma_var[,<span class="dv">1</span>]),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="fu">expression</span>(sigma[pi]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(ex.fit<span class="sc">$</span>sha_st_var[,<span class="dv">1</span>,<span class="dv">1</span>]),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="fu">expression</span>(pi[<span class="st">&quot;k,i&quot;</span>]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">apply</span>(ex.fit<span class="sc">$</span>sha_st_var[,,<span class="dv">1</span>],<span class="dv">1</span>,var)),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">var</span>(pi[<span class="st">&quot;k,i&quot;</span>]<span class="sc">^</span><span class="dv">2</span>)) ,<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(def.par)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The top left plot shows the marginal distribution of <span class="math inline">\(\mu_{\pi,i}\)</span> and the top right plot being
<span class="math inline">\(\sigma^2_{\pi,i}\)</span>. The bottom left
plot shows the prior distribution of <span class="math inline">\(pi_{k,i}^2\)</span>. For the same reason that
describes the variance of the random walk on the truth, we felt that
<span class="math inline">\(\sigma^2_{\pi,i}\)</span> should not be
larger than 0.2. For a similar reason to the correlation parameters, the
variance of <span class="math inline">\(\sigma^2_{\pi,i}\)</span> will
also be small.</p>
<p>For the auto regressive parameter, <span class="math inline">\(r_{k,i}\)</span>, we set a boundary avoiding prior
<span class="math display">\[\begin{equation*}
\frac{r_{k,i} + 1}{2} \sim{}\text{beta}(2,2).
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rbeta</span>(<span class="fl">1e5</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">*</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>,<span class="at">probability =</span> T,<span class="at">xlab=</span><span class="fu">expression</span>(r[<span class="st">&quot;k,i&quot;</span>]),<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="shared-discrepancies" class="section level1">
<h1>Shared discrepancies</h1>
<div id="long-term-shared-discrepancy" class="section level2">
<h2>Long-term shared discrepancy</h2>
<p>We set the prior on the long-term shared discrepancy to be <span class="math display">\[\begin{equation*}
\mathbf{\delta}\sim{}N(0,5^2I).
\end{equation*}\]</span> This is a fairly vague prior as we did not
expect the simulators to differ by the truth by more than 5 degrees of
magnitude.</p>
</div>
<div id="short-term-shared-discrepancy" class="section level2">
<h2>Short-term shared discrepancy</h2>
<p>The shared short-term discrepancy for the <span class="math inline">\(k\)</span>th model follows an auto-regressive
process, <span class="math display">\[\begin{equation*}
\mathbf{\eta}^{(t)}\sim{}N(R_{\eta}\mathbf{\eta}^{(t-1)},\Lambda_{\eta})
\end{equation*}\]</span> with <span class="math inline">\(R_{\eta}=\text{diag}(r_{\eta,1},\ldots,r_{\eta,4})\)</span>
<span class="math display">\[\begin{equation*}
\Lambda_{k} = \Pi_{k}  P_{k} \Pi_{k},
\end{equation*}\]</span> where <span class="math inline">\(P_{\eta}\)</span> is a correlation matrix and
<span class="math inline">\(\Pi_{\eta}=\text{diag}(\pi_{\eta,1},\ldots,\pi_{\eta,4})\)</span>.</p>
<p>We put a uniform prior on all correlation matrices, <span class="math display">\[\begin{equation*}
P_{\eta}\sim{}LKJ(1),
\end{equation*}\]</span> and, for similar reasons for the variance of
the random walk on the truth we set <span class="math display">\[\begin{equation*}
\pi_{\eta,i}^2\sim{}\text{gamma}(1,10),
\end{equation*}\]</span> which has an expectation of 0.1, and is</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rgamma</span>(<span class="fl">1e5</span>,<span class="dv">1</span>,<span class="dv">10</span>)),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="fu">expression</span>(pi[eta]<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>and the standard deviation of</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">sqrt</span>(<span class="fu">rgamma</span>(<span class="fl">1e5</span>,<span class="dv">1</span>,<span class="dv">10</span>))),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="fu">expression</span>(pi[eta]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For the auto regressive parameter, <span class="math inline">\(r_{k,i}\)</span>, we set a boundary avoiding prior
<span class="math display">\[\begin{equation*}
\frac{r_{\eta,i} + 1}{2} \sim{}\text{beta}(2,2)
\end{equation*}\]</span> or</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rbeta</span>(<span class="fl">1e5</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">*</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>,<span class="at">probability =</span> T,<span class="at">xlab=</span><span class="fu">expression</span>(r[<span class="st">&quot;k,i&quot;</span>]),<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="prior-predictive-distribution" class="section level1">
<h1>Prior predictive distribution</h1>
<p>The prior predictive distribution is then</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">EnsemblePrior</span>(<span class="dv">4</span>,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ind_st_params =</span><span class="fu">IndSTPrior</span>(<span class="st">&quot;hierarchical&quot;</span>,<span class="fu">list</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">4</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">list</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>),<span class="at">AR_params=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ind_lt_params =</span> <span class="fu">IndLTPrior</span>(<span class="st">&quot;lkj&quot;</span>,<span class="fu">list</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dv">1</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sha_st_params =</span> <span class="fu">ShaSTPrior</span>(<span class="st">&quot;lkj&quot;</span>,<span class="fu">list</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="dv">1</span>,<span class="at">AR_params=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sha_lt_params =</span> <span class="dv">5</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>prior_density <span class="ot">&lt;-</span> <span class="fu">prior_ensemble_model</span>(priors, <span class="at">M =</span> <span class="dv">4</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">sample_prior</span>(<span class="at">observations =</span> <span class="fu">list</span>(SSB_obs, Sigma_obs),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">simulators =</span> <span class="fu">list</span>(<span class="fu">list</span>(SSB_ewe, Sigma_ewe,<span class="st">&quot;EwE&quot;</span>),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(SSB_fs ,  Sigma_fs,<span class="st">&quot;FishSums&quot;</span>),</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(SSB_lm ,  Sigma_lm,<span class="st">&quot;LeMans&quot;</span>),</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(SSB_miz, Sigma_miz,<span class="st">&quot;mizer&quot;</span>)),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">priors=</span>priors,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">sam_priors =</span> prior_density)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(samples)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ices_ns" class="csl-entry">
ICES. 2020. <span>“Report of the Working Group on the Assessment of
Demersal Stocks in the North Sea and Skagerrak.”</span> <em>ICES
Scientific Reports. 2:61. 1353, ICES, Copenhagen</em>. <a href="https://doi.org/10.17895/ices.pub.6092">https://doi.org/10.17895/ices.pub.6092</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
