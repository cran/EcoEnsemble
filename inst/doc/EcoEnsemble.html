<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="James A. Martindale and Michael A. Spence" />

<meta name="date" content="2025-03-18" />

<title>EcoEnsemble</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">EcoEnsemble</h1>
<h3 class="subtitle">An R package for combining ecosystem models</h3>
<h4 class="author">James A. Martindale and Michael A. Spence</h4>
<h4 class="date">2025-03-18</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>When managing ecosystems, management decisions are often informed by
outputs of complex ecosystem models (henceforth referred to as
simulators). There are often several such simulators available, each
providing different outputs with potentially different implications for
management actions. While some simulators are better at capturing some
aspects of the ecosystem than others, in general no simulator is
uniformly better than the others (<span class="citation">Chandler
(2013)</span>), and often the average of simulators outperforms all of
the simulators individually (<span class="citation">Rougier
(2016)</span>).</p>
<p>Management decisions on the basis of a single simulator are therefore
very sensitive to the choice of simulator ( <span class="citation">Collie et al. (2016)</span>, <span class="citation">Essington and Plaganyi (2013)</span>, <span class="citation">Fulton, Smith, and Johnson (2003)</span>, <span class="citation">Hart and Fay (2020)</span>, <span class="citation">Gaichas (2008)</span>) and by ignoring other available
simulators, we limit the amount of information utilised and increase our
uncertainty (<span class="citation">Spence et al. (2018)</span>), often
to a greater extent than we formally recognise.</p>
<p>Instead of choosing one simulator, it is possible to combine them
using an ensemble model. However, many such methods, such as weighting
schemes (e.g. Bayesian model averaging, <span class="citation">Banner
and Higgs (2017)</span>, <span class="citation">Dormann, et al.
(2018)</span>), explicitly assume that one of the simulators correctly
describes the truth (<span class="citation">Chandler (2013)</span>). Not
only is this a strong assumption, but treating a suite of simulators as
containing the true model tends to underestimate the uncertainty because
alternative, possibly as yet undeveloped, simulators could give
predictions outside of the current range (<span class="citation">Chandler (2013)</span>). Under this scheme, adding a
new simulator to the suite could increase the uncertainty of the
ensemble despite the additional information contained in the new model
(<span class="citation">Dormann, et al. (2018)</span>). For an ensemble
model with a robust quantification of uncertainty, uncertainty should
decrease as simulators are added (or at worst stay the same).</p>
<p><span class="citation">Spence et al. (2018)</span> developed an
ensemble model treating individual simulators as exchangeable and drawn
from a population of possible simulators. They separated each individual
simulator’s discrepancy into a discrepancy shared between the simulators
and discrepancy that is specific to the simulator. This scheme allows
simulator discrepancies that are not independent, which is expected
since individual simulator are often similar, having similar processes,
forcing inputs or fitted using similar data (<span class="citation">Rougier and Beven (2013)</span>). By modelling in this
way, the ensemble model exploits the strengths whilst discounting the
weaknesses of each individual simulator (<span class="citation">Chandler
(2013)</span>), whilst robustly quantifying the uncertainty allowing for
more accurate advice.</p>
<p><code>EcoEnsemble</code> is an <code>R</code> package that implements
the ensemble model of <span class="citation">Spence et al. (2018)</span>
when the simulators either output the quantity of interest or not.</p>
</div>
<div id="model-description" class="section level1">
<h1>Model description</h1>
<p>At time <span class="math inline">\(t\)</span>, the true quantity of
interest for <span class="math inline">\(d\)</span> variables, <span class="math inline">\(\mathbf{y}^{(t)}=(y_1^{(t)},\ldots,y_d^{(t)})&#39;\)</span>,
is described by <span class="math inline">\(m\)</span> simulators, <span class="math inline">\(\mathbf{\hat{x}}_{k}^{(t)}=(\hat{x}_{k,1}^{(t)},\ldots,\hat{x}_{k,n_k}^{(t)})&#39;\)</span>,
with <span class="math inline">\(n_k\)</span> outputs each relating to
one of the variables of interest, for <span class="math inline">\(k=1,\ldots,m\)</span>, and noisy observations of
the variables of interest, <span class="math inline">\(\hat{\mathbf{y}}^{(t)}=(\hat{y}_1^{(t)},\ldots,\hat{y}_d^{(t)})&#39;\)</span>.</p>
<p>Not all of the simulators output all the variables over the whole
time period. To accommodate these differences, <span class="citation">Spence et al. (2018)</span> introduced a latent
variable, known as the “best guess”, <span class="math inline">\(\mathbf{x}_{k}^{(t)}=({x}_{1}^{(t)},\ldots,{x}_{d}^{(t)})&#39;\)</span>,
which represents simulator <span class="math inline">\(k\)</span>’s
output if it described all <span class="math inline">\(d\)</span>
variables at time <span class="math inline">\(t\)</span> with no
parameter uncertainty. In <code>EcoEnsemble</code>, variables of
interest are either present or absent in each simulator, therefore if
the <span class="math inline">\(k\)</span>th simulator was evaluated at
time <span class="math inline">\(t\)</span>, its output is <span class="math display">\[
\mathbf{\hat{x}}_{k}^{(t)}\sim{}N(M_k^{(t)}\mathbf{x}_{k}^{(t)},\Sigma_k),
\]</span> where <span class="math inline">\(M_k^{(t)}\)</span> is an
<span class="math inline">\(n_k\times{}d\)</span> matrix and <span class="math inline">\(\Sigma_k\)</span> reflects the parameter
uncertainty of the <span class="math inline">\(k\)</span>th
simulator.</p>
<p>The true values of the variables of interest at time <span class="math inline">\(t\)</span> is simulator <span class="math inline">\(k\)</span>’s “best guess” plus a discrepancy term,
<span class="math inline">\(\mathbf{\zeta}^{(t)}_k\)</span>, <span class="citation">Kennedy and O’Hagan (2001)</span>, i.e.  <span class="math display">\[
\mathbf{y}^{(t)} =  \mathbf{x}_{k}^{(t)} + \mathbf{\zeta}^{(t)}_k.
\]</span> The discrepancy term, <span class="math inline">\(\mathbf{\zeta}^{(t)}_k\)</span>, is split between
discrepancies that are shared between all of the simulators, and
discrepancies that were specific to the <span class="math inline">\(k\)</span>th simulator. These two discrepancies
are further split into fixed discrepancies, the long-term shared
discrepancy, <span class="math inline">\(\mathbf\delta\)</span>, and
simulator <span class="math inline">\(k\)</span>’s long-term individual
discrepancy, <span class="math inline">\(\mathbf\gamma_k\)</span>, and
dynamic discrepancies, the short-term shared discrepancy, <span class="math inline">\(\mathbf\eta^{(t)}\)</span>, and simulator <span class="math inline">\(k\)</span>’s short-term individual discrepancy,
<span class="math inline">\(\mathbf{z}_k^{(t)}\)</span>, i.e. <span class="math display">\[
\mathbf{\zeta}^{(t)}_k = \mathbf\delta + \mathbf\eta^{(t)} +
\mathbf\gamma_k + \mathbf{z}_k^{(t)}.
\]</span> The long-term individual discrepancy for the <span class="math inline">\(k\)</span>th simulator is <span class="math display">\[
    \mathbf{\gamma}_k\sim{}N(\mathbf{0},C_{\gamma}).
\]</span> The short-term discrepancy terms, <span class="math inline">\(\mathbf\eta^{(t)}\)</span> and <span class="math inline">\(\mathbf{z}_k^{(t)}\)</span>, follow an
auto-regressive processes of order one, <span class="math display">\[
\mathbf{\eta}^{(t)}\sim{}N(R_{\eta}\mathbf{\eta}^{(t-1)},\Lambda_{\eta})
\]</span> and <span class="math display">\[
\mathbf{z}_{k}^{(t)}\sim{}N(R_{k}\mathbf{z}_{k}^{(t-1)},\Lambda_{k})
\]</span> respectively, where the diagonal elements of <span class="math inline">\(R_i, (i = \eta, 1, 2, \ldots, m )\)</span> are
between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span>, and the off-diagonal elements are
<span class="math inline">\(0\)</span>.</p>
<p>In the absence of any other information, the true variables evolve
according to a random walk, <span class="math display">\[
\mathbf{y}^{(t)}\sim{}N(\mathbf{y}^{(t-1)},\Lambda_y),
\]</span> with noisy observations, <span class="math display">\[
\mathbf{\hat{y}}^{(t)}\sim{}N(\mathbf{y}^{(t)},\Sigma_y),
\]</span> when there are observations at time <span class="math inline">\(t\)</span>.</p>
<div id="dynamic-linear-model" class="section level2">
<h2>Dynamic linear model</h2>
<p>The ensemble model can be written as a dynamical linear model, by
letting <span class="math display">\[\begin{equation}
\mathbf\theta^{(t)}=(\mathbf{y}^{(t)&#39;},\mathbf\eta^{(t)&#39;},\mathbf{z}_1^{(t)&#39;},\ldots,\mathbf{z}_m^{(t)&#39;})&#39;,
\end{equation}\]</span> so that <span class="math display">\[\begin{equation}
\mathbf\theta^{(t)}|\mathbf\theta^{(t-1)}\sim{}N(A\mathbf\theta^{(t)},\Lambda),
\end{equation}\]</span> with <span class="math display">\[\begin{equation}
A=
\begin{pmatrix}
I_d &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0\\
0 &amp; R_\eta &amp; 0 &amp; 0 &amp; \ldots &amp; 0\\
0  &amp; 0 &amp; R_1  &amp; 0 &amp; \ldots &amp; 0\\
0  &amp; 0 &amp; 0 &amp; R_2  &amp; \ldots &amp; 0\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots
\\
0  &amp;  0 &amp; 0 &amp; 0 &amp; \ldots &amp; R_m
\end{pmatrix},
\end{equation}\]</span> with <span class="math inline">\(I_d\)</span>
being a <span class="math inline">\(d\)</span> dimensional indicator
matrix, and <span class="math display">\[\begin{equation}
\Lambda=
\begin{pmatrix}
\Lambda_y &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0\\
0 &amp; \Lambda_\eta &amp; 0 &amp; 0 &amp; \ldots &amp; 0\\
0  &amp; 0 &amp; \Lambda_1  &amp; 0 &amp; \ldots &amp; 0\\
0  &amp; 0 &amp; 0 &amp; \Lambda_2  &amp; \ldots &amp; 0\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots
\\
0  &amp;  0 &amp; 0 &amp; 0 &amp; \ldots &amp; \Lambda_m
\end{pmatrix}.
\end{equation}\]</span> The observations <span class="math display">\[\begin{equation}
\mathbf{w}^{(t)}=(\mathbf{\hat{y}}^{(t)&#39;},\mathbf{\hat{x}}^{(t)&#39;}_1,\ldots,\mathbf{\hat{x}}^{(t)&#39;}_m)&#39;
\end{equation}\]</span> are <span class="math display">\[\begin{equation}
S^{(t)}\mathbf{w}^{(t)}\sim{}N(S^{(t)}B(\mathbf{\theta} +
\mathbf\zeta),S^{(t)}\Sigma^{(t)}S^{(t)&#39;})
\label{eq:DLM_obs}
\end{equation}\]</span> where <span class="math display">\[\begin{equation}
B=
\begin{pmatrix}
I_d &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0\\
M_1 &amp; M_1 &amp; M_1  &amp; 0 &amp; \ldots &amp; 0\\
M_2  &amp; M_2 &amp; 0 &amp; M_2  &amp; \ldots &amp; 0\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots
\\
M_m  &amp;  M_m &amp; 0 &amp; 0 &amp; \ldots &amp; M_m
\end{pmatrix},
\end{equation}\]</span> <span class="math display">\[\begin{equation}
\mathbf\zeta=(\mathbf{0}&#39;,\mathbf{\delta}&#39;,\mathbf\gamma&#39;_1,\ldots,\mathbf\gamma&#39;_m)&#39;,
\end{equation}\]</span> with <span class="math inline">\(\mathbf{0}\)</span> being a <span class="math inline">\(d\)</span> dimensional vector of 0s, <span class="math display">\[\begin{equation}
\Sigma=
\begin{pmatrix}
\Sigma_y &amp; 0  &amp; \ldots &amp; 0\\
0 &amp; \Sigma_1 &amp;   \ldots &amp; 0\\
\vdots &amp; \vdots  &amp; \ddots &amp; \vdots \\
0  &amp;  0  &amp; \ldots &amp; \Sigma_m
\end{pmatrix}
\end{equation}\]</span> and <span class="math inline">\(S^{(t)}\)</span>
is a matrix that is used to describe which variables are observed at
time <span class="math inline">\(t\)</span>. The <span class="math inline">\(S^{(t)}\)</span> matrix is an <span class="math inline">\(r(t) \times \left(d + \sum_{k=1}^m
n_k\right)\)</span> matrix, where <span class="math inline">\(r(t)\)</span> is the total number of observations
and simulator outputs available at time <span class="math inline">\(t\)</span>, with each element given by <span class="math display">\[
S^{(t)}_{i, j} =
\begin{cases}
  1 &amp; \mathrm{if\ the \ }i^{th} \mathrm{\ available\ observation\ /\
model\ output\ is\ the\ }j^{th}\mathrm{\ of\ all\ possible\ observation\
/\ model\ outputs.} \\
  0 &amp; \mathrm{otherwise}
\end{cases}
\]</span></p>
<p>For example, if all observations and the simulators give an output at
time <span class="math inline">\(t\)</span> then <span class="math inline">\(S^{(t)}=I_{d+\sum_{k=1}^{m}n_k}\)</span>. If all
simulators output the variables of interest but there are no
observations then <span class="math inline">\(S^{(t)}\)</span> is a
<span class="math inline">\(\left(\sum_{k=1}^m n_k\right) \times \left(d
+ \sum_{k=1}^m n_k\right)\)</span> matrix, equal to <span class="math inline">\(I_{d+\sum_{k=1}^{m}n_k}\)</span> with the first
<span class="math inline">\(d\)</span> rows removed.</p>
</div>
</div>
<div id="dataset-for-the-north-sea" class="section level1">
<h1>Dataset for the North Sea</h1>
<p>We demonstrate the ensemble model by investigating what would happen
to the spawning stock biomass (SSB) of four species in the North Sea
(<span class="math inline">\(d=4\)</span>), Norway pout <em>(Trisopterus
esmarkii)</em>, Atlantic herring <em>(Clupea harengus)</em>, Atlantic
cod <em>(Gadus morhua)</em>, and Common sole <em>(Solea solea)</em>. We
used four simulators and estimates of SSB from single-species
assessments to predict the true SSB from 1984 to 2017, and the SSB from
2018 to 2050 under MSY.</p>
<div id="observations" class="section level2">
<h2>Observations</h2>
<p>Noisy observations of the SSB were taken from single-species stock
assessments (<span class="citation">ICES (2020b)</span>, <span class="citation">ICES (2020a)</span>). The uncertainty is species
specific so the off diagonal elements of <span class="math inline">\(\Sigma_y\)</span> are zero and the diagonal
elements are calculated from the uncertainty in the stock assessments.
These values, and the associated uncertainty are contained in the
<code>SSB_obs</code> and <code>Sigma_obs</code> variables. The
<code>SSB_obs</code> data frame contains a row for each year, with a
column for each species observed. Note that for
<code>EcoEnsemble</code>, the rows and columns of all observations and
model outputs must be named appropriately in order for the data
transformations to behave correctly.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>SSB_obs</span></code></pre></div>
<pre><code>##        N.pout  Herring      Cod     Sole
## 1984 11.53972 13.86278 11.68698 10.82104
## 1985 10.87273 13.94398 11.67321 10.75943
## 1986 10.53821 13.95565 11.59347 10.56377
## 1987 11.07868 14.12404 11.61039 10.46929
## 1988 10.92890 14.38788 11.60985 10.66864
## 1989 10.93916 14.40130 11.52822 10.54621
## 1990 11.19557 14.45303 11.40660 11.70158
## 1991 11.45647 14.32903 11.39265 11.41377
## 1992 11.92440 14.08046 11.35452 11.41658
## 1993 11.70154 13.75959 11.38934 11.00324
## 1994 11.34564 13.82125 11.46735 11.35678
## 1995 12.07449 13.88803 11.61586 11.04353
## 1996 12.24150 13.99439 11.61139 10.55631
## 1997 12.23397 14.11788 11.51042 10.37926
## 1998 12.14652 14.27156 11.48011 10.10641
## 1999 11.59913 14.29834 11.31878 10.82919
## 2000 12.09568 14.33469 11.07164 10.63916
## 2001 12.10364 14.57959 11.02282 10.43383
## 2002 11.38740 14.74728 10.92518 10.43432
## 2003 10.97972 14.77429 10.94854 10.19813
## 2004 10.64428 14.74631 10.72920 10.58993
## 2005 10.33339 14.66267 10.78703 10.38302
## 2006 10.88878 14.45728 10.70340 10.14277
## 2007 11.27246 14.24745 11.24691  9.79971
## 2008 11.45204 14.29349 11.33443 10.44982
## 2009 11.80148 14.46043 11.40682 10.34941
## 2010 12.29722 14.52045 11.39446 10.33850
## 2011 12.07977 14.69997 11.47416 10.30843
## 2012 11.18241 14.75281 11.45062 10.53285
## 2013 11.36872 14.66026 11.50785 10.71819
## 2014 11.27795 14.62658 11.56849 10.65632
## 2015 11.58259 14.53820 11.69435 10.68983
## 2016 11.80500 14.67299 11.69274 10.96791
## 2017 11.93270 14.45042 11.63958 10.98351</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>Sigma_obs</span></code></pre></div>
<pre><code>##             N.pout    Herring         Cod        Sole
## N.pout  0.05754841 0.00000000 0.000000000 0.000000000
## Herring 0.00000000 0.00717835 0.000000000 0.000000000
## Cod     0.00000000 0.00000000 0.005876582 0.000000000
## Sole    0.00000000 0.00000000 0.000000000 0.003132204</code></pre>
</div>
<div id="simulators" class="section level2">
<h2>Simulators</h2>
<p><strong>EcoPath with EcoSim</strong> (EwE) is an ecosystem model with
60 functional groups for the North Sea (<span class="citation">ICES
(2016)</span>). It outputs all four species from 1991 until 2050, in the
variable <code>SSB_ewe</code>, meaning that <span class="math inline">\(n_1=4\)</span> and <span class="math inline">\(M_1=I_4\)</span>. The covariance of the EwE’s
output, <span class="math inline">\(\Sigma_{1}\)</span>, was calculated
in <span class="citation">Mackinson et al. (2018)</span> and is stored
in the variable <code>Sigma_ewe</code>,</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>Sigma_ewe</span></code></pre></div>
<pre><code>##                N.pout      Herring          Cod          Sole
## N.pout   0.0092767506 0.0018710743 8.518305e-04 -1.110854e-04
## Herring  0.0018710743 0.0039672500 4.596743e-04  4.272881e-04
## Cod      0.0008518305 0.0004596743 5.436722e-03  5.581591e-05
## Sole    -0.0001110854 0.0004272881 5.581591e-05  3.140728e-03</code></pre>
<p><strong>LeMans</strong> is a discrete time length-based model that
describes growth and predation (<span class="citation">Thorpe et al.
(2015)</span>). It outputs all four species from 1986 until 2050, in the
variable <code>SSB_lm</code>, meaning that <span class="math inline">\(n_2=4\)</span> and <span class="math inline">\(M_2=I_4\)</span>. The covariance of the LeMans’
output, <span class="math inline">\(\Sigma_{2}\)</span>, was calculated
in <span class="citation">Thorpe et al. (2015)</span> and is stored in
the variable <code>Sigma_lm</code>,</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>Sigma_lm</span></code></pre></div>
<pre><code>##              N.pout     Herring         Cod        Sole
## N.pout   0.18223924  0.08142913 -0.02918675  0.12076725
## Herring  0.08142913  0.10463628 -0.01512463  0.13288178
## Cod     -0.02918675 -0.01512463  0.08047544 -0.02147398
## Sole     0.12076725  0.13288178 -0.02147398  0.22548435</code></pre>
<p><strong>mizer</strong> is a size-based model that describes
ontogenetic feeding and growth, mortality, and reproduction driven by
size-dependent predation and maturation processes (<span class="citation">Blanchard et al. (2014)</span>). It outputs all four
species from 1984 until 2050, in the variable <code>SSB_miz</code>,
meaning that <span class="math inline">\(n_3=4\)</span> and <span class="math inline">\(M_3=I_4\)</span>. The covariance of the mizer’s
output, <span class="math inline">\(\Sigma_{3}\)</span>, was calculated
in <span class="citation">Spence, Blackwell, and Blanchard (2016)</span>
and is stored in the variable <code>Sigma_miz</code>,</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>Sigma_miz</span></code></pre></div>
<pre><code>##                N.pout       Herring          Cod          Sole
## N.pout   0.3024728305  0.0324192572 -0.001061507  0.0003276015
## Herring  0.0324192572  0.0680834748  0.023446726 -0.0006754709
## Cod     -0.0010615068  0.0234467261  0.171557394  0.0015845629
## Sole     0.0003276015 -0.0006754709  0.001584563  0.0073544837</code></pre>
<p><strong>FishSUMS</strong> is a discrete time length-based model that
describes growth, density-dependent mortality, and losses due to fishing
and predation by explicitly modelled species, and seasonal reproduction
(<span class="citation">Speirs, Greenstreet, and Heath (2016)</span>).
It outputs Norway pout, Atlantic Herring, and Atlantic Cod (i.e. it does
not output Sole), from 1984 until 2050, in the variable
<code>SSB_fs</code>, meaning that <span class="math inline">\(n_4=3\)</span> and <span class="math display">\[\begin{equation}
    M_4=
    \begin{pmatrix}
    1 &amp; 0 &amp;  0 &amp; 0\\
    0 &amp; 1  &amp; 0 &amp; 0\\
    0 &amp; 0 &amp; 1 &amp; 0
    \end{pmatrix}.
\end{equation}\]</span></p>
<p>The covariance of the FishSUMS’ output, <span class="math inline">\(\Sigma_{4}\)</span>, was calculated in <span class="citation">Spence et al. (2018)</span> and is stored in the
variable <code>Sigma_fs</code>. Its value is</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>Sigma_fs</span></code></pre></div>
<pre><code>##               N.pout      Herring           Cod
## N.pout   0.003509705 0.0015517547 -0.0020629595
## Herring  0.001551755 0.0074267464  0.0003581727
## Cod     -0.002062960 0.0003581727  0.0071381322</code></pre>
<p>The single-species stock assessments for the 4 species, along with
the model outputs are plotted below.</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="fitting-the-model" class="section level1">
<h1>Fitting the model</h1>
<div id="prior-configuration" class="section level2">
<h2>Prior configuration</h2>
<p>In <code>EcoEnsemble</code>, short-term discrepancies (<span class="math inline">\(\mathbf{z_k^{(t)}}, \mathbf{\eta^{(t)}}\)</span>)
are modelled using auto-regressive processes of order one, so that <span class="math display">\[\begin{align}
    \mathbf{z}_{k}^{(t)} &amp;
\sim{}N(R_{k}\mathbf{z}_{k}^{(t-1)},\Lambda_{k}), \\
    \mathbf{\eta}^{(t)}&amp;
\sim{}N(R_{\eta}\mathbf{\eta}^{(t-1)},\Lambda_{\eta}).
\end{align}\]</span> Note also that the long-term individual
discrepancies (<span class="math inline">\(\mathbf{\gamma}_k\)</span>)
are drawn from a normal distribution <span class="math display">\[\begin{equation}
    \mathbf{\gamma}_k  \sim{}N(\mathbf{0},C_{\gamma}). \\
\end{equation}\]</span></p>
<p>To include prior beliefs in the ensemble model, we therefore need to
place priors on <span class="math inline">\(m+2\)</span> different
covariance matrices - <span class="math inline">\(\Lambda_{1},
\Lambda_2, \ldots \Lambda_m, \Lambda_{\eta}, C_\gamma\)</span>. In
<code>EcoEnsemble</code>, the choice of prior parametrisations is the
same for all of these matrices, however it should be noted that the
interpretation of each is different. In particular, the <span class="math inline">\(\Lambda\)</span> matrices are covariances of a
dynamic auto-regressive process across time, while <span class="math inline">\(C_\gamma\)</span> is the covariance of the
distribution of static long-term discrepancies across different
simulators.</p>
<p>In <code>EcoEnsemble</code>, we follow the approach of <span class="citation">Spence et al. (2018)</span> and decompose the
covariance matrices into correlation matrices and a diagonal matrix of
variances, i.e. </p>
<p><span class="math display">\[\begin{equation}
    \Lambda = \sqrt{\mathrm{diag}(\mathbf{\pi})}  P
\sqrt{\mathrm{diag}(\mathbf{\pi})},
\end{equation}\]</span> where <span class="math inline">\(\mathbf{\pi}\)</span> is the vector of variances
of each species, and <span class="math inline">\(P\)</span> is the
correlation matrix. Here we write <span class="math inline">\(\Lambda\)</span> for any of <span class="math inline">\(\Lambda_k, \Lambda_\eta, C_\gamma\)</span>.</p>
<p>There are three available prior parametrisations for covariance
matrices. In each case, the variance terms are parametrised by
inverse-gamma distributions, while the correlation matrices can be
parametrised either by an LKJ distribution, an inverse-wishart
distribution, or by Beta distributions.</p>
<p>Configuring these options in <code>EcoEnsemble</code> package is most
easily done using the <code>EnsemblePrior</code> constructor. A set of
default priors is available which produce weakly informative priors that
hold for a wide range of different datasets. We can set</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co">#Setting priors for an ensemble model with 4 variables of interest.</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">EnsemblePrior</span>(<span class="dv">4</span>)</span></code></pre></div>
<p>If desired, priors can be manually configured for finer control, for
example we can set</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>priors_custom <span class="ot">&lt;-</span> <span class="fu">EnsemblePrior</span>(</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>                        <span class="at">d =</span> <span class="dv">4</span>,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                        <span class="at">ind_st_params =</span> <span class="fu">IndSTPrior</span>(<span class="st">&quot;lkj&quot;</span>, <span class="fu">list</span>(<span class="dv">25</span>, <span class="fl">0.25</span>), <span class="dv">30</span>),</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                        <span class="at">ind_lt_params =</span> <span class="fu">IndLTPrior</span>(</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>                          <span class="st">&quot;beta&quot;</span>,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                          <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">25</span>, <span class="dv">25</span>, <span class="dv">10</span>),<span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.1</span>)),</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>                          <span class="fu">list</span>(<span class="fu">matrix</span>(<span class="dv">40</span>, <span class="dv">4</span>, <span class="dv">4</span>), <span class="fu">matrix</span>(<span class="dv">40</span>, <span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>                          ),</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>                        <span class="at">sha_st_params =</span> <span class="fu">ShaSTPrior</span>(<span class="st">&quot;lkj&quot;</span>, <span class="fu">list</span>(<span class="dv">25</span>, <span class="fl">0.25</span>), <span class="dv">30</span>),</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>                        <span class="at">sha_lt_params =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>This is:</p>
<ul>
<li><code>ind_st_params</code> - The individual short-term discrepancies
<span class="math inline">\(\mathbf{z}_{k}^{(t)}\)</span>.
<code>IndSTPrior(&quot;lkj&quot;, list(25, 0.25), 30)</code> encodes that we use
<span class="math inline">\(\mathrm{\text{Gamma}(25, 0.25)}\)</span>
priors for the variances of all species and an <span class="math inline">\(LKJ(30)\)</span> prior on the correlation
matrix.</li>
<li><code>ind_lt_params</code> - The individual long-term discrepancies
<span class="math inline">\(\mathbf{\gamma_k}\)</span> use an <span class="math inline">\(\mathrm{\text{Gamma}(25, 0.25)}\)</span> prior for
the variances of the first 3 species and an <span class="math inline">\(\mathrm{\text{Gamma}(10, 0.1)}\)</span> prior for
the variance of the final species. The correlation matrix uses a <span class="math inline">\(\mathrm{Beta}(40, 40)\)</span> distribution for
each of the off-diagonal elements.</li>
<li><code>sha_st_params</code> - The shared short-term discrepancies
<span class="math inline">\(\mathbf{\eta}^{(t)}\)</span> use <span class="math inline">\(\mathrm{\text{Gamma}(25, 0.25)}\)</span> priors
for variances of all species and an <span class="math inline">\(LKJ(30)\)</span> prior on the correlation
matrix.</li>
<li><code>sha_lt_params</code> - Unlike the other discrepancies, the
shared long-term discrepancy <span class="math inline">\(\mathbf{\mu}\)</span> is not decomposed into
correlation matrices and variances. Instead, a Gaussian distribution is
used as the prior on each of the species. <code>sha_lt_params</code>
encodes that the standard deviation of this Gaussian prior is
<code>3</code>.</li>
</ul>
</div>
<div id="model-fitting" class="section level2">
<h2>Model fitting</h2>
<p>The ensemble model parameters are fit using the
<code>fit_ensemble_model</code> function, which converts the data into
the required form. Hamiltonian Monte Carlo then samples from the
posterior distribution using the <code>rstan</code> package <span class="citation">Stan Development Team (2020)</span>. A sample of the
ensemble parameters can then be generated using the
<code>generate_sample</code> function.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>fit_sample <span class="ot">&lt;-</span> <span class="fu">fit_ensemble_model</span>(<span class="at">observations =</span> <span class="fu">list</span>(SSB_obs, Sigma_obs),</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>                                 <span class="at">simulators =</span> <span class="fu">list</span>(<span class="fu">list</span>(SSB_ewe, Sigma_ewe, <span class="st">&quot;EwE&quot;</span>),</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>                                                   <span class="fu">list</span>(SSB_lm,  Sigma_lm,  <span class="st">&quot;LeMans&quot;</span>),</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>                                                   <span class="fu">list</span>(SSB_miz, Sigma_miz, <span class="st">&quot;mizer&quot;</span>),</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>                                                   <span class="fu">list</span>(SSB_fs,  Sigma_fs,  <span class="st">&quot;FishSUMS&quot;</span>)),</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>                                 <span class="at">priors =</span> priors)</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">generate_sample</span>(fit_sample)</span></code></pre></div>
<p>Note that for the simulators, we pass through the name of the
simulators as the third argument. This is not required, however provides
more accurate error messages and appropriately labeled plots when
needed.</p>
</div>
<div id="results" class="section level2">
<h2>Results</h2>
<p>Results can be shown by calling <code>plot</code> on an
<code>EnsembleSample</code> object. This plots the observations,
simulator outputs, and the ensemble model prediction for the truth for
each of the variables of interest. The ensemble model prediction also
shows ribbons for the quantiles if a full sampling is performed (by
default these are the 5% and 95% quantiles).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">plot</span>(samples)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can change which variable we plot by passing through a
<code>variable</code> option, and are free to change the aesthetics in
the same way as other <code>ggplot2</code> plots, see the ggplot manual
<span class="citation">Wickham (2016)</span>. Different quantiles can
also be specified with the quantiles option, e.g.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">plot</span>(samples, <span class="at">variable =</span> <span class="st">&quot;Cod&quot;</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)) <span class="sc">+</span> </span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Set2&quot;</span>)  <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;SSB (log tonnes)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="case-studies" class="section level1">
<h1>Case Studies</h1>
<div id="visualising-priors" class="section level2">
<h2>Visualising priors</h2>
<p>Priors can be visualised using the
<code>prior_ensemble_model()</code> function and/or the
<code>sample_prior()</code> function. These models are quick to evaluate
and indicate what restrictions the priors place on the ensemble outputs,
for example using the priors from the previous section.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>prior_model <span class="ot">&lt;-</span> <span class="fu">prior_ensemble_model</span>(<span class="at">priors =</span> priors, <span class="at">M =</span> <span class="dv">4</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>prior_samples <span class="ot">&lt;-</span> <span class="fu">sample_prior</span>(<span class="at">observations =</span> <span class="fu">list</span>(SSB_obs, Sigma_obs),</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>                                 <span class="at">simulators =</span> <span class="fu">list</span>(<span class="fu">list</span>(SSB_ewe, Sigma_ewe, <span class="st">&quot;EwE&quot;</span>),</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>                                                   <span class="fu">list</span>(SSB_lm,  Sigma_lm,  <span class="st">&quot;LeMans&quot;</span>),</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>                                                   <span class="fu">list</span>(SSB_miz, Sigma_miz, <span class="st">&quot;mizer&quot;</span>),</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>                                                   <span class="fu">list</span>(SSB_fs,  Sigma_fs,  <span class="st">&quot;FishSUMS&quot;</span>)),</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>                                 <span class="at">priors =</span> priors, prior_model)</span></code></pre></div>
<p>The <code>sample_prior()</code> function produces an
<code>EnsembleSample</code> object which can be plotted in the same way
as other <code>EnsembleSample</code> objects.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">plot</span>(prior_samples)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAGwCAMAAABy/YdMAAABd1BMVEUAAAAAADoAAGYAOmYAOpAAZmYAZpAAZrYAsPYAujgAv8QypNsyrEMysHoysLMzMzM6AAA6ADo6AGY6Ojo6OmY6OpA6ZmY6ZrY6kJA6kLY6kNtNTU1NTW5NTY5NbqtNjshhnP9mAABmADpmAGZmOgBmOjpmOmZmOpBmZjpmZmZmZpBmkJBmkNtmtttmtv9uTU1uTY5ubqtuq6tuq+R/lOKOTU2OTY6ObquOjsiOq+SOyP+QOgCQOjqQOmaQZpCQkDqQkGaQkLaQkNuQ27aQ2/+rbk2r5P+0nBa2ZgC2Zjq2Zma2kDq2kGa2tma225C2/7a2/9u2//+3nwDC583C6OnElxbIjk3Ijm7IyP/I///V4fXbkDrbkGbbtmbb25Db2//b/7bb/9vb///kq27kq47k/8jk///m4cLna/Pqbdjr6+vu1NLy8vLz1u/z2df1ZOP2aMv4dm3+5OL/tmb/yI7/25D/29v/5Kv//7b//8j//9v//+T///9l4Je4AAAACXBIWXMAAAsSAAALEgHS3X78AAAcxElEQVR4nO2djX/bNnrHGc+du9Rx0zRpWqnN6qR3Xbee2p7TNzu9vZwaOdu6TtuUXqb2drVzXireZkuyZtnlHz+8kQQoggJJgAKE5/dJZIqGiJ/x5YMXEgKDCOSlglUbAK1GAN5TAXhPBeA9FYD3VADeUymAn91s4ddbfeNm6ok6XPRpn/PZzSDYEvbM73cb9qAEfqNfXHx2FK0MvHWaovK8OhDI2wn+1t+2ALw+zXc76HX2Go/aUvD/+lU/LtCrR39HqilUW13rkp2zW9/u4u2VKwU/3w1QUM1uv7fxL/j/rT46d4OgRVz/+UFnxT5xwFPRQoymQfCSneD7060E/MFGf77bwmct+gMo+L4dUYZbTqSN/hViO9w8mt3sROQ/Moi6KVNsHP0iWDn4zSO6wQqRuGo8ctTAXz3qJuBRuQ23SFzd79oFPo742ByqTMl/tIf+wEVOK9pVKgHPfBJXlkZ8NLvLg59u/oDMok1LwePQvxaflbFB9H9IXa/YZ1LVT6mdoc3go8O/cSvi2XsRvB0RTx2gVxcino3pMPjNI+SZb542+mIPdVVKwOOTM6XNbdrRxpMGnZWj7W08ekV8o8MWMvxB3D/GXodB8OYDVNKrL81Mrz4ZcvSFc+DmCvrPi0LdeHIBhxUi+vGmjREvaPVNZE01X6naKa/A4yYpHUX7La/A45bJhktNNgjuznkqAO+pALynAvCeSgH8KKOFHSp7anxI9U8Bn2V8AnhPfQJ4T30CeE99AnhPfQJ4T30CeE99AnhPfdoBPiSahLHIvtUXaMZVyHZxe+jeVfskyrha9BmGNoDPsVVstHmfMle2+Rzlno42gWfxsRhJegpUmyZlVe7w2spzlJSlJvCXn7bfefbz1+2/1GhUwZYtkeSKT6zqPvPAH+9Hx3vne9HTfR/Bu+KTSC94pPP9548jxD569dVXVf+gIpWuPVdVhbpzgma46wF/+fnJdxS8HqNKtqwoUBM+TTSdES1WzeAvP3sWPdcIXs3W2oI30XQmneWqPvPAX3z8LIp0GlWztbbgI/1NZ1Sp9eQ/ngf+abvd3tNZNXkPXnfTiXbU9dnIOF7Nlg3gzfjU3XSONJygAF50asKn9qZzBOCdAK+96RwBeM3gXfEJ4AF8VZ8AXjTqhk8A76dPHX2RJsAr2lp9gbriE8AD+Mo+Abxo1AmfAN5X8Bp8ugxe++1OQz4BvOYC1X6705BPAK+/QPXe7qw2T2gFM4W8B6/5dqcxn5rB6/DpNHhfZwrp8NnEUihVa9BlVai3M4UaAl/XqKqt1d/uNOTTU/DKttajQF3xWQ88PlqOUZSnkMSnAnXFZx3wXA6LvjKJvCnQJqSjz6QJfCgWX7qnRPH5At4OnxXBJ98VT3LgTMV5ZpN4UaCu+KwGPi+HxFNunt4UqCs+9YEXIhzA2+6zEvgKeXpToK74BPCaC9QVnwBeKE8nfAJ4AF/dZxXwVfJ0oUBd8QngAXx1nwBeKE8nfK4KfKU8XShQV3wCeABf3Wd58NXybKBAa8vUTKGMbAZ/vB/9/HX77cdZo9UZuhBJrvg0B/5pez+6/GLRqHIOAN5J8Je/QxF/8VH73gk3X71yPVhDqkXpGXgtPqVV/fledPElZ7RUDhDx1vuUgo8icb56qRwAvPU+peBx0PPz1UvlAOAXyjO3s2wj+Ox89VI5AHhBss6yfeBzCrRUDgCeV25nuYa0dJYBvHnwuZ3lVfsE8A2BjyJtX+7U4hPANwQ+21letU/94HdilbXVDPhQ+PJHo716XV/u1OJTK3jCe3ub7RHOAEvAswOne/j3Fvl0APwOp+2QUEcvYh1gTYGmh2Z/k79NUgp+vhv86lG3FHgWztvbMe9Ywua2XvBLfBYVH5+BpPys8Nko+KuDzmFndudIBTzDuhPznRC+Qp7xO3JG7Ggs0GU+pcWnluXqfTYNfv6gf9hBLyrgw7hmL8iTngg0CSI/2cnREqM7eQW6zCdXWCHXmOdlkOdDG/gSPlcLnpyh083lEU9LapsP8fw8uSTbC5C580cqeSQV+EyLh7jizGdOuJ20BeLg6414FZ+rBo/bpGAj5wTNgN+plOf29namMajTdiY+5Tc/ksPFzne49ialL/ZXdlROxxwt9Wk1eKkE8FWba7JDQK+htyy9+bFwOMUxJWmSyv9xTvfq8Qmaf4ry4Ct30NkOobefrQYm7BeFBcr5lN78YPckdnayG8u0M1FNKb35oVqe1oAnmrakZ2jCvTCHhw/RP6bcJClvYQ9LQzeTs0EaSbHP/JsfaVPOXjkTSW6L5x35A/WO4wvK0y7wBb3QszAuQR5zVmhfkoaiZ7uX2MpSoG+lBRr7zL35kcmAq7snKIcBUprVJCzf8ygB3oVePdHsVl5vhOiM1ISCHk4mZ1j4B7+f7sMJkJKNCpJ5SXzm3fyQ/92Y8WAcjseDQZJmMB7T02BgAnxueZoAf6akgja+oKo/o1lwXNChxmOSq5gz2jU4422Nx2N942PeZ4mZQrR1iYmzn4MBsUvhbyu6quDTLHha5MZ69fjgXK2NYeNqc4xDKJvDeBCyM4C8Cwl7LC6Jgqr0luPjD9KwDuMe4wTvQucr+isGtMDOyPnLHG1vazxBl/msCn7BQ2y/Gnh6fhb36s9o+302IRGOMhzQAh5nChlzJ0VMKwlaCzAThD09BSoVqIpPInRCTgZJTxJjH6QVEttA/NlJvKAiV3p8VgS/nVFqNee6ebYDU3Ecf0a5k1jH2VHwKHYGE9x0ctzRHrojKcOztLDisJ+EcSMhbaKqR/yAZsCdj4MzcaAxEBgmv2PXG9TazDo+T6uAD7NXyc+4cRKusMbiaZF5nw9+uDziaVYTHNK4hufA80WMuIeT+EwYs9+IUUQOc5ZiF/6Y/DNU3SeuheLDJW364GzZ0CJvEMqSpCOOxVGMdPSxxOci+DC5tSABz18GidvbpFmsfgHnfvewM92SnqGkcSThPsHIUQ2fdpQmIRfyY7pnQGv1uOhZ6xC/SbdVjSr7ZE1QGE7SruaA5qZyoal4nJH9EBt9lPLJdMq/WXI1iCXYzlw4Qn3ryhea+Ltzw1bR3bmHcR0/oTQH+eAJd9Z/HifcacXOeJPTp8Zdr0KfXMMRjz0Q9gViUvDLk+jxOTolHx1x84KYshGfZile5RyLoVM14q8edadbBUYHSSU4GbNenZADI49fE/BcC5C2SRV7oao+40tI8eEGCL3QgBdnqQ38cp+sHBaXlhHAc1kKdzrGlHu56yJ54KPp5o8HBePOFPw4C5W1pmTUxk4IAn6wCL5+gS7zmQVfMssGfZ5xh0t7EfhHPnihhz7GHxe6JMbG8SwPPEzKy2HAxmpJb3kwyFYKS2zpGR+HD6WHaxb8Mp88+Jg5vVUR8uv/Z9IQ4VsQmUFKdfDz3byzky/QsYA2m4N4TWySTabxilixz4fyw5E9I/7iHn6SRmlXenyGCflJmLlTtE0yyIDnudN4r+eTi3g0/sjthMbgB3QAN5DkINT/JiNpiU+qUf4iTUJphmH8CJXV+JR2drYX9tA5jOyuI4q+hzrBI00LxscPB2QUN1g5+CU+sejnFjPI1KCFl0IN+8RXO89kGWTJk/Yf32YkF8nxyLq2z1IRPyjMYZC8rDLiUxUPk+jZsdCNajLiB+RmRxpI5B3NIHODGu3Z2aG/pZcTNIJXaDuX3bnkevEGx8dLfPLgBfKj7Pg4C17vN2kU2nhS2eObxOnwmN4yTrty9C4D0g65HcbmONDLp/V8KvfqFcCHgwbAL/MpQk0OtYjZMPhlPukncWU/JuzTvvAgGbwx7OMxm0yS9OMbBr80h4F82L4i8Kx88zBbAZ5eAs+IVv5sYD8g08fwnnT4lvchc+N4lRxWCr62Sl33ll0DX65RhvxiQaTRz00DTyNP8YJ3FfCwBk4DPtmH8/ppA9pdQtST5lXkbgg8nq+efUpzqRwAvIpP+uH8DvpgQIM9Bp/hbgY8ma/OnssOK1saAv9ukie7FkM4818gG8fDO2GagPotropV/XePYYFDoz7fjXOdnJ0l3wLIyYBAT/aMjIN/DuDN+ozBj3bC7KwUPgNhJgGZuKOnPIvWsoU23qhPSv76dXJpGaNfuG6c1vFkD0p9eqrLJ/TqVwYek79+PfFwepq4IBmIN9tZGn0+YbmzJsBLVr16913BwyndtzjrM05zqtEngG8AfN7wGOs6wszr9JScCpkMEp+nOn0CePPgc4fHSNcXk9Kpt/lD2mRarpbhMYA3Dz53eCzxcIqbev6GcpImnYivxSeAbwh8dngsdXUq3F5KwKfcAbxT4PPa+HxXp7k+Abyj4EusZXt6mt0zivhdWnwC+CbAl/WZJS+eClp8qj9pskwOAL6mTwH06akBnwDeSvBcjJOtVYLPLipULk9bCrRwj1U+ycDulJ0AAN4f8CM+7G0Dr15aNvSWnQMv2aOlPMs8RnzheKktMYPR4rdYjBSo7Bp4xQIF8MXgo3iTt8Udnu4pb6t0gcqugVeWT1PEyoNnJjLgE9B5p4Ih8GWugSvtMebTTfCKWjz5ydvKt5JUIqnMNXAAXznil9kK+VZf9GnDNXAAbwq8UaMy8B726rX4dBu8hQXqik8Ar7lAXfEJ4DUXqCs+AbzmAnXFJ4DXXKBNSMfwGMA3Dt4On02A96pAXfEJ4D31CeA99QngPfUJ4D31CeA99QngRaNO+NRRngBeNOqETx3l2Qh4Vwp04avplvpUcwXgS+xxw6eaq4rgf/66/fZjpwpUhwxNERNkOfjLL/QZdSWSRvmPtbDOp5qriuAvPmrfO9E0bdmVSALwSOd70cWXnhWoKz7VXFXv3GmbtuxKgTrj0yR4PHNZ17RlZwrUFZ+Ge/Xapi3jHU4UqDM+XRnH4x1OFKgrPl0CX+FrlCsBX+Fbfyo+bbsu0iB4MwVqwKfoVJNPvddF6vdFmgRvpECN+BwVuarmU+91kWoXRvgDNAveQIGa8ZlIm0/bros0DB4rXHy6Z/LH5H1opeBFV6xAM+tCqPrUeV0k6YQmzrLPHuf7VTk+VwC+7IdWDF6TT83XRWr7BPAN+dR9XaSuTwDvqU8A76lPAO+pTwDvqU8A76lPLcudKVyMUrlepeeaVr0MvPEJ4Mt7WAufAL68h7XwqW9lS5BTAvCeCsB7KgDvqWqAv/y0/c4zcu8hfZEmSbfkaaLo4pOT3DS1BD7zcqsB/ng/Ot4ji0enL9Ik6Zb8MOhvvXeSm6aWwGeez3pV/fk+WS4+fZEmEbZkaY5//fmJLA341OuzFvjLz0/IAyLSF2kSfkuW5uKTP0rT1BL4XFQd8JefPYuWnKFJEm5Lmua43W7LTvQ6Ap85mdUAf/HxsygqbpPSJOmW/DDkXNXfdoJPzW38U3xCFfdC0yTpljwNMaq/tww+83KDcbynAvCeCsB7KgDvqQC8pwLwnsoM+KuDDv5x2DJydH3y2KehiL961I2i6ZaZg2uUvz5NVfWzO0fz94+Q2SBAdof4dXb7vY2+oewqy1ufxtr4YetJl/iNDjvY9YP+7LWuqcxqyFef5jp3pEFCJ2gQtKLZzeBaF5u2UJ76NAge90doszTd6M/vW1ugfvo0DB5VR6hHiuxO7Y0kP30aBk87I/Pd4KXdjs0F6p9PuIDjqQC8pwLwngrAeyoA76kAvKcC8J4KwHsqAO+pALynAvCeCsB7KgDvqQC8p1IBf3UQkJleTLNb1s1IA5WWCvjDLQw/IQ/g10EK4Of38aS+FDeAXwcpgE+DnczxI+Dnu4F9U5BBJaRS1SPKpImf73bwPD8EHn+zY7hp5QwlkJoUe/WI/RYN9ftd9INtmbUGMinl4dzste4UxTiKdQz+JurnXwPwDksB/JS05pQ4F/Egp6XUucOtOWrSxTYe4Dstpar+EFXsGL7Qq4ea3mnBJVtPBeA9FYD3VADeUwF4TwXgPRWA91Rr9GxZUBkBeE8F4D0VgPdUAN5TAXhPlQc+8xRDAL+OygOfeYohgF9HSar65CmGr76q8oh63ZogrSBbn5QPXniKoaGIn4RIdDOkmoQZQcSbUy548SmGusHLMAP4JpUHPvMUQ53gizAD+CaVBz7zFEON4AsxA/gm1eQ4fglmAN+kmgO/FDOAb1KNgV+OGcA3qabAK2AG8E0KwHsqAO+pALynAvCeCsB7qobAq2AG8E0KwHsqAO+pmgGvhBnANymHweMH7Hai7PMW4/fkodsgqdwFj1dkyXmSdgze0geFWqNGwKthLguekp3d+f3t94K3DoIW2nH1CD9qdxgEW1cHwSbeaEWz2+/BIpyLauTbspOKKj7qIVlVFYF/rYsiH/1k4NHP+YM+OgFQnYBXZ1usFUAuR3yE19vc6BPQmHIC/ogszoV+4oetH9r6cOhVy2nwUTRsCeBxgN/5YYMEOoAvlLvg8YKbeLnNFPytPqnyf9iKpiTiWVUP4PPkLvgIdd1w3y0Bf3QY/NkvEOc/7AYv7Xbmu6RztzjeAxE5DB5URwDeUwF4TwXgPRWA91QA3lO5C/5P/5vRn7QWzLoLwHsqAO+pALynAvCeCsB7qrUDj2fiBR3JZ6at+IW+pTf44rfDDpcIHUWYuDPsxJ/7v6P0CO5q/cAXQcmCxw9Tu5kPvpU51DBOtiazOPPBH+9HP3/dfvsxeWMt+LEgAfwUxyt55DV62TyavnFz4xv0Zvo6fmmRfTjVGx9G3/9Vh8zPQ/te79DEKfjp6xvf7sa/nLZQwo3+MNgiWyhh4PAjtXPBP23vR5dfxO+sBS+t6hHcLRSiKEiv/gu9IICbR0O8B+1Gb1pkH0771m9+/M0/dYataIj3HXZo4pZ4mGhKf0l+M91CEY924I/Q3zqq3LVsf4ci/uKj9r0TTStbGplsWVjVo9dhhzwOEz8lcwsTa9FmenZ32iL7SKonv/2HYecJqvDvopdhJ07MHYbsIr8k/ElVjz7XJQdaM/Ckqj/fiy6+JG8ci/gUPPnJfjDwScSztNMPUJQLES90BOLDpBE/u/OHNOLXEnwU6VvZsumqPqBMhqyhJ28p+KSNDyjd+YP+UGzjg5YInuxibTwK/2vdq4OkjV9L8DjoNa1sqYgZxvFNqqhXr2tlSwBvoZoYxwN4C+Uw+AVpLZh1F4D3VA6D/++MAHwZAXhPBeA9FYD3VADeU60feLIsQvFt+TWZS1FLawcer4k0v98tBLsmcylqyWXw/yaIgWc32MjtGG4mxusb375/dPVVn9QHmbkUJJm2EnVELoPPjfgY/Ba9JRvPxNiKoifd2V1UyeMb9eJcCpJMW4k6ohQ8Ou9/9ShvgSg3weMpF8JMDHYiHARBJzOXgiTTXrKWKwF/ddCRLBTkFvi4jd+KJ1Qkkyvmv/xlH4V9dMhHfDJhQ3vJWq4E/PxBH5XIg5y2zi3wca/+dTIvkpuJEUWHW2SexgetzFyKocuTJqtKjPjppvMRD1KT0MYbOvGrzrVcMtkSwNfR2vXqQWpK2/jdIPutISZbwcP9+DoSIz63c2sA/A01AXhzEsEr9eoxw2rgE6JaIv7fMwLwZSSCx4PgBeWBF8mrgKe8XyklAG9OmTZepaqngTni4MvBv4z1yisJdJ1tPICvowq9+l7MZSn4l18m4X7jxisZ6AB+5WLgabyr9eqTmjgUMfNBTkXqea5FH5cUgDen0hH/8su9sNfr/fRT2HslxhvxuMVTIbxBg5eAhIi3Ryn4oUrEY64/YfVC/PrixQtcA8S4xao+JLU8w25gHJ8Pnl8KpXBZFM+Vdu7udw/x14gXxUI3HBG+L170ME8U9uMerutfvKAnAD4FEuG3P4Xk3CDYjVzAkYDn+qf+3XNTF393btgqGMeHpDOHcPaiOJR7dB8lhn9HTwBMG+8h0Al8JBPg/0IQD/7qK/zHvP8DgJcqvTv3qDvdKgBPAxjR6EWkEidRT4AzYiP6Lr5ewyp51B8IOf4NRDxpsL7v/vNf//7DhaWrQInSNn66+eNBwTi+F1OLwSP0lGmPJ0a5hxOGPYzHfizJT6VUvaqfvvX3//hNB6p6uZR79YxhD4NndFlU93rJyD4OfPKLHpF6fOts4+e/+PD7230ALxd35U5WSkkb3yPcCfgRRdyjTf04Dv3kfJik75oGTy9AkkklU9nFSBAf8UO6FNSCkiE5a6/pjpCdC7i+n4xxaPcY6xuEoci9OfAgNWVuyxaO4wUcSS1wgxLr0QoBt/x8FZ80+gDeLuVHfP4aOCHttYtnQq93gxIjqG+wvn7KcGRsIgaAr6PcNh6vbHm+Fz1duuoVAT5id9jJD1bfC7duDYGHiRh1JF3Z8vljss5d8cqWbEokekHQyZveuLcwU9LQZMv/yAjAl5F0ubPvHqsscEgDm43sR0mNj4I3k8hAxAP4OpKCf64EfsTAj0Zxa94L89IAeNtUtJbt8jaeARdbfQDvgrSvbBnm1goA3jZp/0IFgHdDDn+TJh+89IkzIEHrDF584gxIkMvgrwviwbMH0ZAnzpCvTfu75IlMLoOXRzxd/oQ+cYYsfuLvkicyrSd4tvwJeeIMWfzE3yVPZFpP8PFCOPiJM2TxE3+XPJFp/cDjYGfLn5AnzpDFT/xd8kSmtQMPUhOA91QA3lM5DB4mYtSRw+D/MyMAX0YA3lM5/Px4AF9HAN5TKYCvLzOTLQF8HUHEe6q1BQ9X5Yu1tuBBxXIZ/LuCGPjpGzc3vgk2+tPWIb1bQx5IA/dmsnIZfG7ETzePhnjWBarqrx51kwfSgDJaP/CtiNyDneLvyEfJA2lAGa0x+GErgtkXUq0v+Dd3g+Dab5MH0oBErR14kJoAvKcC8J7KYfAwEaOOALynchj8/2QE4MsIwHsqAO+pALynAvCeSgr+56/bbz8mWwB+HSUFf/lFvFUf/KhB8LObQXp5nv7AN+aj2V209aQbr49yKFmx2RtJwV981L53smxlS1UZmWwpAX+XS0PA49vxh50YPF0fhe7T8Jc5Kyn4873o4kuyZW3EnwoSwE9bZN0TPB2nP7tzFO9H4Nn6KGSfzyrq3KmsbKm4p9mqHk+8Iuue4Ok4HfyV+c2jGDxdH4Xu01qSjkkKHi9uqbKypXXg04i/1o0XwoiGrRg8XR+F7tNXjO6pqFdfaWVLW8CTF7oQxhaGjB+whf6z9VHoPq0l6ZgaGcevAvyQ1vg44g9JtT4lT51k66OwfR6rIfAjGMdbJgDvqQC8p3IXPKiWmgIfAXi71Bj40VLMAL5JNQc+Sx7Ar1QNgh+J7AH8StUseJ49gF+pGgcv7qGAiz9kvhB81IrBq3zIfCH4KADvqQC8pwLwngrAe6pGVrYE2SeIeE+lJeIVZmCrTNLWMZEbpCgA76kAvKeCzp2nAvCeCsB7KgDvqWqAv/y0/c4z8oWb9EWaJN2Sp4mii09OctOAtKsG+OP96HjvfC96up++SJOkW/LDoHPn3kluGpB21avqz/efP47O99IXaRJhS5bm+Nefn8jSgPSqFvjLz0++w5zSF2kSfkuW5uKTP0rTgDSrDvjLz55FSyI+ScJtSdMct9ttWcUB0qwa4C8+fkYWTyho49Mk6Zb8MCT2oY1vRjXAP8UBWtyrT5OkW/I0BDz06psRjOM9FYD3VADeUwF4TwXgPRWA91RmwOPVYpEOvV5QzG4ZivirR126iCzIUpmq6md3jubvH0V4dTm8liBZP/r2e/BUZ2tkrI0ftp50CX+8cjQ6Cx70Z691TWUGKi1znTvSwOPlJIMWXln4WhdWjLZJBsGTBzmTZn660Z/fB/BWyTB4VL2jHj7CP4WIt0uGwdPO3Xw3eGkXHg5gleACjqcC8J4KwHsqAO+pALynAvCeCsB7qv8H+SUM5fCLtwsAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="finer-fitting-control" class="section level2">
<h2>Finer fitting control</h2>
<p>Using the wrapper functions
<code>fit_ensemble_model, generate_sample</code> is the easiest way to
generate samples from the ensemble model. However, for finer control,
the model can be fit directly with <code>rstan</code>. To create data in
the correct form of the model, simply create an
<code>EnsembleData</code> object using the constructor.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>ens_data <span class="ot">&lt;-</span> <span class="fu">EnsembleData</span>(<span class="at">observations =</span> <span class="fu">list</span>(SSB_obs, Sigma_obs),</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>                          <span class="at">simulators =</span> <span class="fu">list</span>(<span class="fu">list</span>(SSB_ewe, Sigma_ewe, <span class="st">&quot;EwE&quot;</span>),</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>                                            <span class="fu">list</span>(SSB_lm,  Sigma_lm,  <span class="st">&quot;LeMans&quot;</span>),</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>                                            <span class="fu">list</span>(SSB_miz, Sigma_miz, <span class="st">&quot;mizer&quot;</span>),</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>                                            <span class="fu">list</span>(SSB_fs,  Sigma_fs,  <span class="st">&quot;FishSUMS&quot;</span>)),</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>                          <span class="at">priors =</span> priors)</span></code></pre></div>
<p>The <code>EnsembleData</code> object has 4 slots:
<code>observations</code>, <code>simulators</code>, <code>priors</code>,
and <code>stan_input</code>. The first 3 slots are the data as passed
through in the constructor. The <code>stan_input</code> slot is
automatically generated by transforming the other data into the form
required for the Stan implementation of the ensemble model. To fit the
model, the compiled <code>rstan</code> object can be retrieved through
the <code>get_mcmc_ensemble_model()</code> method. This takes an
<code>EnsemblePrior</code> object as input and returns the compiled
<code>stanmodel</code> corresponding to the form of the prior.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">get_mcmc_ensemble_model</span>(priors)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>samples <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">sampling</span>(mod, <span class="at">data =</span> ens_data<span class="sc">@</span>stan_input)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">EnsembleFit</span>(ens_data, <span class="at">samples =</span> samples)</span></code></pre></div>
<p>To generate individual samples of the ensemble parameters with this
output, now call the <code>get_transformed_data</code> and
<code>gen_sample</code> functions:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Generating samples using DIY functions</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>transf_data <span class="ot">&lt;-</span> <span class="fu">get_transformed_data</span>(fit)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>mle_sample <span class="ot">&lt;-</span> <span class="fu">gen_sample</span>(<span class="dv">1</span>, <span class="at">ex.fit =</span> rstan<span class="sc">::</span><span class="fu">extract</span>(samples), <span class="at">transformed_data =</span> transf_data,</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>                         <span class="at">time =</span> ens_data<span class="sc">@</span>stan_input<span class="sc">$</span>time)</span></code></pre></div>
<p>The equivalent code using wrapper functions:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fit_ensemble_model</span>(<span class="at">observations =</span> observations, <span class="at">simulators =</span> simulators,</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>                          <span class="at">priors =</span> priors)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>samples_tmp <span class="ot">&lt;-</span> <span class="fu">generate_sample</span>(fit)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>samples <span class="ot">&lt;-</span> samples_tmp<span class="sc">@</span>samples</span></code></pre></div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-banner_higgs" class="csl-entry">
Banner, Katharine M., and Megan D. Higgs. 2017. <span>“Considerations
for Assessing Model Averaging of Regression Coefficients.”</span>
<em>Ecological Applications</em> 27: 78–93.
</div>
<div id="ref-blanchard" class="csl-entry">
Blanchard, Julia L., Ken H. Andersen, Finlay Scott, Niels T. Hintzen,
Gerjan Piet, and Simon Jennings. 2014. <span>“Evaluating Targets and
Trade-Offs Among Fisheries and Conservation Objectives Using a
Multispecies Size Spectrum Model.”</span> <em>Journal of Applied
Ecology</em> 51: 612–22.
</div>
<div id="ref-chandler" class="csl-entry">
Chandler, Richard E. 2013. <span>“Exploiting Strength, Discounting
Weakness: Combining Information from Multiple Climate
Simulators.”</span> <em>Philosophical Transactions of the Royal Society
A: Mathematical, Physical and Engineering Sciences</em> 371 (1991).
</div>
<div id="ref-Collie_16" class="csl-entry">
Collie, Jeremy S, Louis W Botsford, Alan Hastings, Isaac C Kaplan, John
L Largier, Patricia A Livingston, Eva Plaganyi, Kenneth A Rose, Brian K
Wells, and Francisco E Werner. 2016. <span>“Ecosystem Models for
Fisheries Management: Finding the Sweet Spot.”</span> <em>Fish and
Fisheries</em>, 101–25.
</div>
<div id="ref-Dormann_18" class="csl-entry">
Dormann, Carsten F., Justin M. Calabrese, Gurutzeta Guillera-Arroita,
Eleni Matechou, Volker Bahn, Kamil Barton, Colin M. Beale, et al. 2018.
<span>“Model Averaging in Ecology: A Review of Bayesian,
Information-Theoretic, and Tactical Approaches for Predictive
Inference.”</span> <em>Ecological Monographs</em> 88: 485–504.
</div>
<div id="ref-Essington_13" class="csl-entry">
Essington, Timothy E., and Eva E. Plaganyi. 2013. <span>“Pitfalls and
Guidelines for Recycling Models for Ecosystem-Based Fisheries
Management: Evaluating Model Suitability for Forage Fish
Fisheries.”</span> <em>ICES Journal of Marine Science</em>, 118–27.
</div>
<div id="ref-fulton_03" class="csl-entry">
Fulton, Elizabeth, A. Smith, and Craig Johnson. 2003. <span>“Effect of
Complexity of Marine Ecosystem Models.”</span> <em>Marine Ecology
Progress Series</em>, 1–16.
</div>
<div id="ref-Gaichas_08" class="csl-entry">
Gaichas, Sarah K. 2008. <span>“A Context for Ecosystem-Based Fishery
Management: Developing Concepts of Ecosystems and
Sustainability.”</span> <em>Marine Policy</em>, 393–401.
</div>
<div id="ref-Hart_fay" class="csl-entry">
Hart, Amanda R., and Gavin Fay. 2020. <span>“Applying Tree Analysis to
Assess Combinations of Ecosystem-Based Fisheries Management Actions in
Management Strategy Evaluation.”</span> <em>Fisheries Research</em>,
105466.
</div>
<div id="ref-ices_ewe" class="csl-entry">
ICES. 2016. <span>“Working Group on Multispecies Assessment Methods
(WGSAM).”</span>
</div>
<div id="ref-ices_hawg" class="csl-entry">
———. 2020a. <span>“Herring Assessment Working Group for the Area South
of 62 N (HAWG)}.”</span> <em>ICES Scientific Reports. 2:60. 1151 Pp,
ICES, Copenhagen</em>. <a href="https://doi.org/10.17895/ices.pub.6105">https://doi.org/10.17895/ices.pub.6105</a>.
</div>
<div id="ref-ices_ns" class="csl-entry">
———. 2020b. <span>“Report of the Working Group on the Assessment of
Demersal Stocks in the North Sea and Skagerrak.”</span> <em>ICES
Scientific Reports. 2:61. 1353, ICES, Copenhagen</em>. <a href="https://doi.org/10.17895/ices.pub.6092">https://doi.org/10.17895/ices.pub.6092</a>.
</div>
<div id="ref-kennedy_ohagan" class="csl-entry">
Kennedy, Marc C., and Anthony O’Hagan. 2001. <span>“Bayesian Calibration
of Computer Models.”</span> <em>Journal of the Royal Statistical
Society: Series B (Statistical Methodology)</em> 63: 425–64.
</div>
<div id="ref-mackinson" class="csl-entry">
Mackinson, Steven, Mark Platts, Clement Garcia, and Christopher Lynam.
2018. <span>“Evaluating the Fishery and Ecological Consequences of the
Proposed North Sea Multi-Annual Plan.”</span> <em>PLOS ONE</em> 13:
1–23.
</div>
<div id="ref-Rougier_16" class="csl-entry">
Rougier, J. C. 2016. <span>“Ensemble Averaging and Mean Squared
Error.”</span> <em>Journal of Climate</em> 29: 8865–70.
</div>
<div id="ref-rougier_13" class="csl-entry">
Rougier, J. C., and K. J. Beven. 2013. <em>Model and Data Limitations:
The Sources and Implications of Epistemic Uncertainty</em>. Cambridge
University Press.
</div>
<div id="ref-fishsums" class="csl-entry">
Speirs, Douglas C., Simon P.R. Greenstreet, and Michael R. Heath. 2016.
<span>“Modelling the Effects of Fishing on the North Sea Fish Community
Size Composition.”</span> <em>Ecological Modelling</em> 321: 35–45.
</div>
<div id="ref-spence_ns" class="csl-entry">
Spence, Michael A., Paul G. Blackwell, and Julia L. Blanchard. 2016.
<span>“Parameter Uncertainty of a Dynamic Multispecies Size Spectrum
Model.”</span> <em>Canadian Journal of Fisheries and Aquatic
Sciences</em> 73: 589–97.
</div>
<div id="ref-spence_ff" class="csl-entry">
Spence, Michael A., Julia L. Blanchard, Axel G. Rossberg, Michael R.
Heath, J. J. Heymans, Steven Mackinson, Natalia Serpetti, Douglas C.
Speirs, Robert B. Thorpe, and Paul G. Blackwell. 2018. <span>“A General
Framework for Combining Ecosystem Models.”</span> <em>Fish and
Fisheries</em> 19: 1013–42.
</div>
<div id="ref-rstan" class="csl-entry">
Stan Development Team. 2020. <span>“RStan: The R Interface to
Stan.”</span> <a href="https://mc-stan.org/">https://mc-stan.org/</a>.
</div>
<div id="ref-thorpe15" class="csl-entry">
Thorpe, Robert B., Will J. F. Le Quesne, Fay Luxford, Jeremy S. Collie,
and Simon Jennings. 2015. <span>“Evaluation and Management Implications
of Uncertainty in a Multispecies Size-Structured Model of Population and
Community Responses to Fishing.”</span> <em>Methods in Ecology and
Evolution</em> 6: 49–58.
</div>
<div id="ref-ggplot" class="csl-entry">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data
Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
