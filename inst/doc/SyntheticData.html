<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="James A. Martindale, Michael J. Thomson and Michael A. Spence" />

<meta name="date" content="2022-09-23" />

<title>Case Study: Synthetic Data</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Case Study: Synthetic Data</h1>
<h4 class="author">James A. Martindale, Michael J. Thomson and Michael
A. Spence</h4>
<h4 class="date">2022-09-23</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(EcoEnsemble)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code></pre></div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In this document, we generate synthetic data for simulator outputs
and observations, then fit the ensemble model using these data. Finally,
we demonstrate the consistency of the ensemble framework and explore
uncertainty levels for different numbers of simulators. We do this for
an ensemble model of 4 simulators, each describing 3 variables of
interest.</p>
</div>
<div id="generating-the-data" class="section level2">
<h2>Generating the data</h2>
<p>We generate the synthetic data by sampling from an informative prior
distribution of the ensemble model. We choose priors with very strong
correlations of individual long-term discrepancies (<span class="math inline">\(\mathrm{Beta}(5,1)\)</span> via the method of
concordance) and high autocorrelations of the AR processes on individual
and shared short-term discrepancies (<span class="math inline">\(\frac{r_i + 1}{2}\sim
\mathrm{Beta}(10,2)\)</span>). These are different to the vague priors
that will later be used to fit the model. We can configure this prior
using the <code>EnsemblePrior()</code> constructor function.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># The number of variables.</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">EnsemblePrior</span>(d,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>                        <span class="at">ind_st_params =</span> <span class="fu">IndSTPrior</span>(<span class="at">AR_params=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">2</span>)), </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>                        <span class="at">ind_lt_params =</span> <span class="fu">IndLTPrior</span>(<span class="st">&quot;beta&quot;</span>,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>                                                   <span class="at">cor_params =</span> <span class="fu">list</span>(<span class="fu">matrix</span>(<span class="dv">5</span>, d, d), </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>                                                                     <span class="fu">matrix</span>(<span class="dv">1</span>, d, d))),</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>                        <span class="at">sha_st_params =</span> <span class="fu">ShaSTPrior</span>(<span class="at">AR_params=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">2</span>)),</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>)</span></code></pre></div>
<p>From this configuration, sampling the ensemble model parameters is
done using the <code>prior_ensemble_model()</code> function. In this
case we sample the prior of an ensemble model with <span class="math inline">\(M = 4\)</span> simulators.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># The number of models we are considering.</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>prior_density <span class="ot">&lt;-</span> <span class="fu">prior_ensemble_model</span>(priors, <span class="at">M =</span> M)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>ex.fit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">extract</span>(prior_density<span class="sc">$</span>samples) <span class="co"># Extracted samples</span></span></code></pre></div>
<p>Of these samples, the data we choose to make up our synthetic data is
the single sample which maximizes the likelihood. Recall that for
<code>EcoEnsemble</code>, the truth and the discrepancy terms follow a
dynamic linear model with</p>
<p><span class="math display">\[\begin{equation}
\mathbf\theta^{(t)}=(\mathbf{y}^{(t)&#39;},\mathbf\eta^{(t)&#39;},\mathbf{z}_1^{(t)&#39;},\ldots,\mathbf{z}_m^{(t)&#39;})&#39;,
\end{equation}\]</span> so that</p>
<p><span class="math display">\[\begin{equation}
\mathbf\theta^{(t)}|\mathbf\theta^{(t-1)}\sim{}N(A\mathbf\theta^{(t)},\Lambda),
\end{equation}\]</span></p>
<p>with <span class="math display">\[\begin{equation}
A=
\begin{pmatrix}
I_d &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0\\
0 &amp; R_\eta &amp; 0 &amp; 0 &amp; \ldots &amp; 0\\
0  &amp; 0 &amp; R_1  &amp; 0 &amp; \ldots &amp; 0\\
0  &amp; 0 &amp; 0 &amp; R_2  &amp; \ldots &amp; 0\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots
\\
0  &amp;  0 &amp; 0 &amp; 0 &amp; \ldots &amp; R_m
\end{pmatrix},
\end{equation}\]</span> with <span class="math inline">\(I_d\)</span>
being a <span class="math inline">\(d\)</span> dimensional indicator
matrix, and <span class="math display">\[\begin{equation}
\Lambda=
\begin{pmatrix}
\Lambda_y &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0\\
0 &amp; \Lambda_\eta &amp; 0 &amp; 0 &amp; \ldots &amp; 0\\
0  &amp; 0 &amp; \Lambda_1  &amp; 0 &amp; \ldots &amp; 0\\
0  &amp; 0 &amp; 0 &amp; \Lambda_2  &amp; \ldots &amp; 0\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots
\\
0  &amp;  0 &amp; 0 &amp; 0 &amp; \ldots &amp; \Lambda_m
\end{pmatrix}.
\end{equation}\]</span></p>
<p>See the <code>EcoEnsemble</code> vignette for further details. The
samples from the prior distribution provide us with <span class="math inline">\(A\)</span> and <span class="math inline">\(\Lambda\)</span> values. To get from these
ensemble model parameters to simulated model outputs requires using the
above transformations. Values of the truth and discrepancy terms are
generated using these values and sums of discrepancy terms to give the
“best guesses” of simulator outputs.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>Time <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>true_par <span class="ot">&lt;-</span><span class="fu">which.max</span>(ex.fit<span class="sc">$</span>lp__)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>latent <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, Time, (M<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span>d)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#Priors on initial values</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>latent[<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span>d] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(d, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>latent[<span class="dv">1</span>, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>d)] <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">chol</span>(ex.fit<span class="sc">$</span>SIGMA_init[true_par,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>d) ,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>d)]))</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>                                          <span class="sc">%*%</span> <span class="fu">rnorm</span>((M<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>d, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#Find all the latent values of the dynamic linear model</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>SIGMA <span class="ot">&lt;-</span> ex.fit<span class="sc">$</span>SIGMA[true_par,,]</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>SIGMA_chol <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">chol</span>(SIGMA))</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>Time) {</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  latent[t,] <span class="ot">&lt;-</span> ex.fit<span class="sc">$</span>AR_params[true_par,] <span class="sc">*</span> latent[t<span class="dv">-1</span>,] <span class="sc">+</span> SIGMA_chol </span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>                                          <span class="sc">%*%</span> <span class="fu">rnorm</span>((M<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span>d, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>}</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#The truth is simply the first d values</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>truth_latent <span class="ot">&lt;-</span> latent[,<span class="dv">1</span><span class="sc">:</span>d]</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#The best guesses are sums of the truth and discrepancies</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>simulator_best_guesses <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="at">dim=</span><span class="fu">c</span>(Time,d,M))</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>  simulator_best_guesses[,,i] <span class="ot">&lt;-</span> <span class="fu">t</span>(</span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>    <span class="fu">t</span>(latent[,<span class="dv">1</span><span class="sc">:</span>d] <span class="sc">+</span> latent[,(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>d)] <span class="sc">+</span> latent[,(<span class="dv">1</span><span class="sc">+</span>i) <span class="sc">*</span> d <span class="sc">+</span> (<span class="dv">1</span><span class="sc">:</span>d)]) <span class="sc">+</span> </span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>      ex.fit<span class="sc">$</span>ind_lt[true_par,i,] <span class="sc">+</span> ex.fit<span class="sc">$</span>sha_lt[true_par,] )</span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>}</span></code></pre></div>
<p>We can see how the truth relates to simulator best guesses by
plotting these outputs, for example for the first variable.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">plot</span>(truth_latent[,<span class="dv">1</span>], <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="dv">3</span>), <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">lines</span>(simulator_best_guesses[,<span class="dv">1</span>,<span class="dv">1</span>], <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">lines</span>(simulator_best_guesses[,<span class="dv">1</span>,<span class="dv">2</span>], <span class="at">col =</span> <span class="dv">3</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="fu">lines</span>(simulator_best_guesses[,<span class="dv">1</span>,<span class="dv">3</span>], <span class="at">col =</span> <span class="dv">4</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="fu">lines</span>(simulator_best_guesses[,<span class="dv">1</span>,<span class="dv">4</span>], <span class="at">col =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In <code>EcoEnsemble</code>, we do not assume that we have access to
the truth, nor the model best guesses. Instead, <code>EcoEnsemble</code>
assumes that model outputs are noisy representations of the best
guesses, and that observations are noisy representations of the truth.
In order to produce the final synthetic dataset, we add noise to the
simulated truth and best guesses. For simulators, this noise represents
parameter uncertainty.</p>
<p>We use gams from the <code>mgcv</code> package to achieve this, and
we overparametrise the model (by setting <span class="math inline">\(k\)</span> - the dimension of the basis used to
represent the smooth term - to be something very large) to ensure that
the outputs are sufficiently smooth.</p>
<p>In addition, we assume that we only have access to the first 40 years
of observations.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>Times_obs <span class="ot">&lt;-</span> <span class="fu">round</span>(Time <span class="sc">*</span> <span class="fl">0.8</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>obs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,Times_obs,d)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  g1 <span class="ot">&lt;-</span> <span class="fu">gam</span>(y<span class="sc">~</span><span class="fu">s</span>(x,<span class="at">k =</span> <span class="dv">15</span>),<span class="at">data=</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>Times_obs,<span class="at">y =</span> truth_latent[<span class="dv">1</span><span class="sc">:</span>Times_obs,i]))</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  obs[,i] <span class="ot">&lt;-</span> <span class="fu">predict</span>(g1)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>}</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>obs.cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(obs <span class="sc">-</span> truth_latent[<span class="dv">1</span><span class="sc">:</span>Times_obs,])</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>model.cov <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>,<span class="at">dim=</span><span class="fu">c</span>(M,d,d))</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>models_output <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="at">dim=</span><span class="fu">c</span>(M,Time,d))</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>    g1 <span class="ot">&lt;-</span> <span class="fu">gam</span>(y<span class="sc">~</span><span class="fu">s</span>(x, <span class="at">k =</span> <span class="dv">15</span>),<span class="at">data=</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>Time,<span class="at">y=</span>simulator_best_guesses[,i,j]))</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>    models_output[j,,i] <span class="ot">&lt;-</span> <span class="fu">predict</span>(g1)</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>  }</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>  model.cov[j,,] <span class="ot">&lt;-</span> <span class="fu">cov</span>(models_output[j,,] <span class="sc">-</span> simulator_best_guesses[,,j])</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>}</span></code></pre></div>
<p>We can see how this data compares to the best guesses by again
plotting the first variable of interest.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">#Observations and model outputs</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">plot</span>(obs[,<span class="dv">1</span>], <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="dv">3</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,Time), <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">lines</span>(models_output[<span class="dv">1</span>,,<span class="dv">1</span>], <span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="fu">lines</span>(models_output[<span class="dv">2</span>,,<span class="dv">1</span>], <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">lines</span>(models_output[<span class="dv">3</span>,,<span class="dv">1</span>], <span class="at">col=</span><span class="dv">4</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="fu">lines</span>(models_output[<span class="dv">4</span>,,<span class="dv">1</span>], <span class="at">col=</span><span class="dv">5</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAJACAMAAABlpiR1AAAAbFBMVEUAAAAAADoAAGYAOpAAZrYil+Yo4uU6AAA6ADo6AGY6Ojo6OpA6kNth0E9mAABmADpmZmZmtrZmtv+QOgCQZgCQkGaQ2/+2ZgC2/7a2///bkDrb2//b/9vb///fU2v/tmb/25D//7b//9v///840tPeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAekUlEQVR4nO2dC3ecOJdo6STl/mZu7Jkbz7RvaiZx7Pr///EWj6IE6HH0ggO191rdsQs4AtX2kQAhmguAYpqtdwDAB4KCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUUFrQBELGVoGXDwVFBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqagr63jR//VMuHDwilQR9a5rvf/7Pr8vHy48S4eBhqSPo29dfl7cue56vP2WHg8eliqBd3vzzr1bQ9y8/J1GiR1HBY1NJ0O/X/3/+z4UMCpnUaeLPt7zZq5obDh6XSidJ5/70/b1xnCMhKMjgOiioBkFBNQgKqkFQUA2CgmoQFFSDoKAaBAXVICioBkFBNQgKqkHQQvzeegcOCoKW4XfL1jtxRBC0CL9Htt6To4GgJejFxNEKIGgBDCkxtDAIms1cSQwtCYLmskyZGFoQBM3EZiOClgNB87BnSwwtBoJm4WjNaeSLgaA5OEXE0FIgaAYeDTG0EAiagU9CDC0DgmbgdRBBi4Cg6QQUxNASIGg6QUExNB8ETSboH4YWAEGTCeuXZ+ipJyPCEUDQZAT2lRD0wTVF0FRE8uUY2luJoKVX3CTcBggFTTZ0IuXjGoqgiQjNQ9BMEDQRqXmphs6UfFhDETQNsXepjTyC9iBoGnLt0gRdCPmohiJoGhHaJRmKoAMImkSMdCmNvEXHBzUUQZOIcg5BM0DQFCKVizbUJiOCFlpxk3ArEy1opKFWGR/TUARNIVa4yPXtKiJomRU3Cbcu8Z3KuC0cKj6koQiaQIqgEZu4RETQIituEm5VUi5sxhjqFPERDUXQeJKuvMsNdWuIoCVW3CTcmiTeXBcbiqAmCBpN6vgkoaE+Cx/QUASNJnmIp2xuWwSdgKCxZDzFITHU7+DjGYqgsWQ9CBc2FEGnIGgseQ+7Bw0NKPhwhiJoJLmTMYQMRdApCBpJ9mwh/o7o6ZTl7/FA0DgKzGZje5nS+B6wq6D+HPtohiJoHEWmW5oo+ntCL6hHUgTNXXGTcKtRaj6w3zOGj3v9fI4iaO6Km4Rbi4Lz1Vnf7nnXz6nogxmKoFHUnlBxYp/dUATNXHGTcGtRWdC5fBZFnxA0c8WOc9M0P7ofvvwsEE4LqybQvsBJkU8tj2VoHUHPf/1z+Xj5dkHQOCzujYo+3am7E7qoIujn6/fu/19/HUvQDfwcDDXUfDBDqwj68dI175e3r79mgjYjEeHUsImgbbHTvPlQhlbMoFfevpFBI3D1Lq9GmiWfHimJVuqDDlp+vDQHEnRLP82yT49kaLWz+L6R/3xFUDEOQTsZJ2VfV3wYRbkOKmcbQQcTpyn0cc6VEFTMpn5OxpH2az6GoQgqZitBx+KXhtbdIRUgqJTq7zW0CmpIaBg6rPoIhiKolE0S6KQZn4/KQ9CkFTcJtwJbCDrrZj5iCkVQIVu08IvToAdMoQgqZIMEujxNHxv529rHNxRBZWyQQG2XkeaGImj8ipuEq06EoGnO2AS17sfvyeqHNxRBZYSnrOn/SR2wKfRzNPQu6MENRVARgimVWmPihhSbgw7Fgi4NFZW1WxBURHhGpX6IUa+LTFFjWGzTLAR1R5gKenRDEVSCwM9J5pQYagzcbv2cVYgvQLc3CJq64ibhKhOc8OvUP812T4NuRW9p8y5o0wk6rRGfdr8fyVAEleAXtPfzcuuI9rgMNdKmVdD+I790naEImrjiJuHqEvTzJolpqF3RScNutvBmXg1K1xp6L+rQhiKogJCgd0VOoSRqPjJ4P0caE+iwOKjcxFAEjVpxk3BVEfj5dP9tlkRna9ufaR3PkaSCXh4mhSJomMB8naephpMLRo4UugxiLh389D+b3c7UeFv+9LSn6owDQcP4Z0Q+zdNk2NBlEHNp0wc0TW6em/nWnaC3fsGBDUXQIAE/Fw7OBBVkQ3OLWwKddFafr9yW3j4bDe222OdMGAIQNIhHUJufNkMDc6lMbyONSo9n+c89s2sAhqD3FLrTOVvcIGiIoJ9+QdsVArP9zG5zLgS9utn0kk4vUp1Ov+eC7nZWIScIGsIrqP2WpMNQT5jJ6v2/Uz8bU9Hb8uGVIJPzqqMZiqAhQoLaPzeJEvRufL+FaeWg6Li8fePCsCaCPqqgCX46DPWEMVedRhz7nuav9y3vD3ouz6yOISqCBvAK6hoRshDUd5btuyw18XH4ZLLpVNDLxM9DGIqgfrzXmNxj4paGesJMbj1NFi39nBp63XRp6GX49xiGIqifQAJ1L5v+7jN0evfeXGLzcyno79u25loIula5G5MoaIShkX5ODG23tRuKoGuVuy2BFt6zcPkIh2Ntc8yHxM/J56ahlhR6/9m9p8pBUC+pCbRXZyJG+IRq0QF1hJ4J6jb0/tN+DUVQH8kJtFNnJobdUPegOaegxpLx3Z62AAP7bu0fSND4uUH8b3YPjMLsRsnPDLWuNi4VJtBlCvUbuu+Low8i6OK1wsKt3MtCfloEtQrknIHBI+gihQ6GBgXdYSp9BEHnr76WWuofqBwcxj4YanziG1gS46dxnnTbPmjo+MPODD26oHMlIxT1rxV+zKIXdLbRfCvnBCFeQS8LQfu9dfdCb/8i6DbhHDhsFCnqXyWcQHtDZx8tDB1nqYtJoBeHob8DfzZ77I0eWlC3hwJD/StInlMTzJl8Gad0mq0XFvR5Xkh7TIHd2uGt+gML6pcwpGhAYNGDlGFDU/28r2GWITL09u9ODD2soMFm3L9CYGNJC+9+L8KTuYZ1foewoA5D5RPrIeia4RYIe5meLoB3U6EHTkNv25/skzUK/LQKKjYUQVcON0N6KcmpaGjzHEENRV1vhZUIeltpWkZUChWtuTEHFDTqgrx93UJ+Og0NTHUr8tOeQmMMtfyoj6MJGn+/yLJ+MEC+oN7JwmWC2lPoZfpueQG6k+mxBI2/mzluZQYI++n2bobHUOdCoZ8OQWMNVd4d3ZOgASvS7DQ2Fd8KjZisq6agw4oWQWOqAUFLhTtZv8+Um+yeMJJ1/Ql09mX7DLUvE/vpSaERNYGghcKdTjND52mv9qu2RryCzr9tj6C5CdQtaLgXbaDaz/0I2to5ue+8tpYjYT+FhuYmUFcbn2CovMi12Yugffa8j37cRM2eUoJmJ1BfCo0yVDM7EXRo3U/DQ2Jb1n37Ng/3UkuPzrV6fgL1CbqxoU8GWYF2I+jt39PUz/Wbp8A1pmWPziFogQTqa+O3NfTpqZSh+xD0/g20hm76wKI/gV5sfzLWDezXJEoKmmBoocqcSpln6C4EPRlnRyfzSYoNLpEEBV3iENS6bpyfhQ0tVJnzpHl4QUc/u9bdfBht/SHi18qOFtS2hStIUUEjDS30577MmDmG7kDQqZ+Th9Gamatl99FGQgKNETTWT9dpkmHo2pfsLS16TiOvX1DTz9sHyycXVmrskxKoxZ9SCTSUQqMMLVGH9nOiDEPVC2r2P5vxo8W0Q8cQNN7PUAqNauZr+Zlj6A4EHX64+tmMhi42X0fQRD8X/pRLoGFBIw2N3oFpoS4Pkw3djaBNJ2gz/dAMqDiB9gMJJr/ZV0sQtKyhefgsVCXox0sz8uVnVrhpAvUIGv7rz3+hZVvJaYJOh7qU9FMg6FqG+rNkoqF1Mujnq8vLEWEku6ABTebhy9x0y0igLafRUWeMJEHd9ztXNjRQv4nVX6mJ/3z9Vibc/RR+orXXE3PNpznCcm1kJNCOm6JFE6goha5haLBu0yq/Vh/0vflRIpyRQKd50SOKkaJnVmYqmivoxUyjFvIE3dhQQcWqErRQuHsCdSywhR4FteiY4WgBPy/z0yWTRD99KXRqaE1FRZWaUvHqBe1VW1auW5WboA4Tkw31ClrgEkKuoP4UWtdQWZUeT9DbXU1L1YZSqM/DJEP7mRYcpRa4yJXsp1vQmRH1DJVWaEK970LQJk7Qy+Cne4WUJOpLoCVuE6QL6kuhqxgqrs2jCmqtV5+hQQHjDQ0nUIWCzo2oc1MpUJdmkfGGqhbUk0CDk3aEYkca+lRb0Aw/LbPZjqQaGnE8IT/Nzu/hBL04/XTbIsyOcYZ6/SzRB80R1JtCkwyN+IuT+HmXNNpQ7YJeogUVt94xzXy/pu/E7HlDP/0pNMVQsaCBShzEvDt6KEHHh4z9yyfMKsxbyXJDn0KCPj+7XlwoJG9rTwpdKCEyVCqozM/x59Ak+rY9Kb5iuXAJgi799NZy3OURzy2g50xDM/30pVCboWFFxX76Fs8LSkmh+gX1vi5z9sGswsJ5IOoCs3OUce9mjqIFBQ028mJDg+tE+tl9lwcS9OanWNBFeyNoqCSGPnkFvXuZnkVz/QwZOv+kyAXRiOb9/ll0CtUpaGdVMIHOjFlWmKQnJR/kYPVz6mSqoQUFXc3QBD9TUqhKQXutwoJOnLHVl6QnJRgmtixsYJkz0xTNF9RrqOUQsw2Nbt6Hj2NTqEZB+7wn8NNwxvH3XKAn9eQW1GZjiqEF/Jy+Adk3eHkgz9DQBRBn9OgUum9BR2kyx3lKHlWwJlDbBvGGFhZUbGiqouEBYWbo03RBpKGHEDT3aQ7f5uMiWwK1bxJraAk/Z1GchhofpxoqGK848XO6L0cQ9CL2s9cm10/Z47ILQd0ebi+o1dDTyPBZiqGS4bRm3FmREW/D61Ep6CVG0Hw9Lx5DExKof1HmyuIwpzkTQwdlopOoaLS3EfT2ENbkryIqheoU9DIIEa6+Mn46Db1/akmg7mhRjXwhQSWGThddhIY+TQjvyNzPe5HD4iMIKkyghfR0RDI/ixI0xtBSfoYDTY/wNN4IsVfykxXBfkz8nJQ3lhjxpe1a0K7Ksh9jM4M5P4jzM8bQYoKWMDTZyjv3cIt+cEoKVS2o38+h7vIftJwEfDJ/me2PQVBAqaHl/BSEshp6uQ2Ey9Hyzu1Lsz2+mmCoUkEFCfRWh1JBpaPHuqiLb2gpaCikRkEvU/duCvmtjBuK7fNzBUHNWZca58RLieUaNRFMoJNqFhUoHCFu/6pcfmYbWtDPGEMjGvK4hwWMSVxti2+GVhTUnDDkvaigZk0EBPV3D63lRT3DsKi/WRld+x0KKWrk1xa0w+Km88VTcY9bBfy893vFhuoR1KwJfws/N0hiaN5jbe4E6k+hQWGK+pkUbT7B+pxYQW9RncX169UStBgCQX1+Tj5YXdBehHDIsKFlBc0z1K5oVMUF/Rxzz3EFtfWWxIZG7qSrgMGDcMiQoYX9TIs3NXRR6VF+SgWVG6pHULMm2qOw+mnvzUt7oVF76I4/ahAOubKguYZaFS3qZ3QKzTiLT++AOsqdniPZBHWcbMZeCo29cjqNX+4+ZnE/EyOax5c+Cs/w0y9o1zzWyqDOuZMj8ZbraOHd10KiDPVN0SmJHjkSxHvLPmY3ZMUlbTYbEJemqHEHSVBYtSY+OHdygXLtCdRzrS5CuPmQM9Em5m/RY+mc65f3s0QK9Vxy8iL185Z/hIbG90FDcydHhrNhE9R/803q203NKEezBHUbmjnVgyto0mazukhQ9HeMoKeagpYhJGicn0JBTSvliub56RSxip/pgs6qIlbRCD+HVQ4laHjsgqhaZl+DUNFcQe2b1PGzVAq9RHZFJ2OUZaUJU6hGQRctvGBsTbha7KNrJNuZvyV9/5aNavmZ3LG1VIRc0Ug/DyCoWTOyoV+hinGOXhB16UcSBZ1vVc3Pgik0op13jFH2l3YUQYVDE4PXNhzLgzU6WZ48tc1ieoekOLKy0raz1oPM0MkzcuLC9izo1E9ZRMHV4dhFy7Cp3/509ruafpYVVKRobAM/rChr4xUKOkmg8pHd3vu/vooL3fgwfsmZvu7uaFU/qxjqc3SyVJOg56b56x/p1jHlmoJGPHng9ix0KuS31/wtz6znZ1PTaqQL6qgHn6K/0/zsVj1ABo16MiYwSNYoez76ITz4pqfEJHTV/UzfS0812B2dfxpzf27Xgo4T7sc9uWXPlDY/Z4Z6e6jGL7XVKkQNQ2/TzC8+kW5vKUvUxusZUT9yEzT+yULHpc5ZyZYRuJ5zfOOXnfhZR9CL+cKO30tdw5svC9unoLcWPunBV8uj2PNasw4Rd3cPjF/u45Tjd2xVahk6czR66/naVQSt+FRnz5BAEx/Mtk9mMSnZ+gyD3VCHn9oNzRA0dqjsZOPY1SVtvL4+aC9o8sQB1umApkVbDbOsO/tI+iTS9qT3RVYUVJhClQqaPrHFoJVvsJLdL+tYEuNXM4EqF3QTQ6O3rCbox8v39iLo11+ROyQrt+uCZvh5uckZX9WTbRYBHkXQVEP1CPr29defv79d3rJG1nsEzfVTNkgpsKHLz130QXOuN6QKmrDd9asOf9HxgrYn8u2o+oxTeF+53V4XmlIxntO9gzBdYFxe1+/nFoYmCSpIoWmCvl3lPNcSdEM/L87+wV6ugQ5kCZpiaMpGlQS9tu0fL19/fbxUauK39fNi7yDszM/1U2jiRuE2Pukkqfnrn9yHO13lbu+nlUcSNLG1TiuohqBFcIW7+lngNZKl2Z2fCJqLI5xOP3co6LqGpp/6VxG0u9+ZdxnUUe7Vz5NCQXfoZ6ag8TeFEgsKptAEQfuZG84Zo5Vd5bZ+ImgZsvY5/rZ6cjnlBf18/d79+5aVQx2CTh5H0sIe/VzV0Jz7o+UFvY24q3KhngRajExB48Yep5dTI4P2F5jO5TPo+oJK7grt08/MR/OiHt7IETTUxif1Qds2/t3bB/18DQwY1SGo6L76TgXN3O+I5zMzhuiFU2idCWzPTd9PHWQWl7uFnyFD9+rnWo18lp/FBZVxO4+6uDsCCFqfVVJonp/hNr6KoMaTS7NTqXv+tW6oUNDdPIhkYQVD8xr4SziFpgj65+/GP2nDXjKopA9qPOixxh4VJVfQsHvZftYQtO9Xnn0TLY8Lo/ug0t0pRIyfGJqwhqCQ0oLe0qP3MtPtZMq5jrVchVdBH1nQcL4okVAChqq6UK9P0D09iGSjrqFFGrzigooyqDycyeotfJDbF7xTP/MFTZzTMqqMwoJK+qAx4QzUCbqvB5FsVEyhZfzsxqh7Gs4qZ/Fx4UbUtfDVJ6KrT+4RSCf+yyrCl0I1DVjWNpDpAH5WbOSLNXf7EVQbR/CzQAoVzrqaUQSCJnEIPys18slTY9hL8BiKoAOLs6BDNPCXAn9nFhWL+omgEhbXkY7iZ5FG3jurWj4IGmRxJb73c68XlyYUSKGmkknzsgUKQNAQc0FHPzG04+5oeT39bTyCdiwFtXy4V4p0Vk4jBYItgh9D0JqdQoufhxG01PWIan4eQ9DKrxgyTGyeDyeo8hM+z93OvQj6/LzSe9r6ovrdO4ifO7ik606h+xDUfM1lZUe78DcvD+KnfkP3LehMyZqG3vQ8ipg3Vm/kI4vbs6A2H2spOup5NEHXNtTskUkKdndC1QtqP8Iqhj4f6urnjDUFfZ4h2MSZQncgqOvzwjV+r8oj+rmmoTMnRd/UbgV1H1yZJBr7l75f1jq+ZUUeWVBfrWYqNW+Hjq3nZa0UaqvJHEN1CxrQJlWrR9LSYIWDdZ4xBLfcq6Ch5fGV/ohq9tQ/Zle1CkrepaCCCo2t9Ad1s6f2kbvjCwp2XGjSLKioPmMq/aHtbKl78P4ThtDWjhSqWFChS2LnHl7PS11DvZUbrvk9CioLJdMOO1sq1kH4hDYQYG+CxjXd4TXQs6VWPYTjCgS1dULVChpVkf6VadsN6lSFJGpoDXsbr1XQyGr0VBB6zqhQHWVOZ3cmaFw8zxU47JxRvErEp7P+5XsSNKEGF5ffH/aCfJiy1SIOFlhvR4Im1d/83jp6uilYMxGhAitaH8jTKmhqXNwUUqqKoqIkFKhSUNxagSJ/xpEBEBSiyJU0dtuDCIqfK5LRI0rYKL4UBAWz4x65VXxJsVsoFBQ/NyHy+kdizyB6IwQFA5GlOT3XAwiKnzqwX1bOvYiHoFCSkm7eIsatr05Q/Dw2CAq6ifyCtQmKn0cHQUE1+xYUP49P3HeMoLAyexYUPx+BqG8ZQWFt9isofj4ECAq6ifmeNQmKnw/CXgWFRyHCUASF9UFQUA2Cgm7khiIobMDGgn68NCNffmaHg8OxdQb9fHV4mRYODofY0EpN/Ofrt5Lh4GhsLejlvflRMhwcjM0FdUUZKRIO9opWQWuFg70hNbSmoJ+v30uGgyOBoKAaBAXVICjoRmgogsI2KBB0xXCwOxAUVIOgoBuZoQgKG4GgoBoEBdUgKOhGZCiCwlYgKKgGQUE1CAq6kRiKoLAZCAqqQVBQDYKCbgSGIihsB4KCahAUVIOgoJuwoQgKG4KgoBoEBdUgKOgmaCiCwpYgKKgGQUE1CAq6CRmKoLApCAqqQVBQDYKCahAUdBMwFEFhWxAUVIOgoBoEBd34DUVQ2BgEBdUgKKgGQUE3XkMRFLYGQUE1CAqqQVDQjc9QBIXNQVBQDYKCahAUVIOgoBuPoQgK24OgoBoEBdUgKOjGbSiCggJWF/TcNM2P7ocvPwuEg4OztqDnv/65fLx8uyAoiFhZ0M/X793/v/5CUBDhNLSKoB8vXfN+efv6C0FBwrqC9hn0yts3BAUJ6wo6NuwfLw2CgoCVBb2exfeN/OfrVNBmJCocHB6XoVwHBRVsIejYFS0TDo4MgoJqEBRUg6CgG4ehCAo62EDQFcPB7kFQUA2Cgm7shiIoKAFBQTUICqpBUNCN1VAEBS0gKKgGQUE1CAqqQVDYHwgKqkFQUA2CgmoQFFSDoKAaBAXVICioBkFBNQgKqkFQUA2CgmoQFFSDoKAaBAXVICioBkFBNQgKqkFQUA2CgmoQFFSDoKAaBAXVICioBkFBNQgKqkFQUA2CgmoQFFSDoKAaBAXVbCYogIiNBF0h8FYFcUCbFISg2srhgMptvEngrQrigDYpCEG1lcMBldt4k8BbFcQBbVIQgmorhwMqt/EmgbcqiAPapCAE1VYOB1Ru400Cb1UQB7RJQdybBNUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQTR1B35vmr3+qRJ7w599+1i/t87Vpmu/1y7lczrf49avv7euv+uV8vLTPF3/LK6iKoO/XvXmvb+jHy5ef1Uv7fL2GPrfVXPuoztej6eLXr773phW0djl//jXEzimohqCfr23CeftWIbTJ9c+yFbRyaX/+/nHp5Kl9VB8v39uD+bZC9V1T21XQ6uW8d/kj8xuqIej4nVaIfee9+d7VwCqlXf/+VymnFbR+Qeev/3UVtHo550HJrIKqCNql9vfKgt6KWKW0ty8/VynnfG0Iqxd0LaDtg1Yv5+3f+957VkE1BO27Gyt0QrtjXqO0a7Zeo5z37vusXVDb4raC1i7n46Xt6L5l1hyCSsq5nSNVP6rP16+/ahd0vnqzhqA91+9InaBHa+Lfu6tM6xxV29mtW1AXfpUmvi/u7x/qmvh1TpIuN0Gr9/X7q6DrHFX7fdYt6DzMf1i7nIGrnepOkla6zDQIWru0c/Oj+7d2Of3X+F7/elbL2wqXmcoc0J4v1A+tRt3S/vz9/VZa5aMapVmh+t7WuFDfKfmWeUB1bnWe17nVOXRrqpY2tIhtAbWP6q1teIcyV7nVuYcDYrAIqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpB0NIsZslaYxq144KgpUHQoiBoaRC0KAhamquPHy//96WfeLCdd/C/h6kb24ma22mGuxcigRAELU0naPt2uut/b+3L45rhl3Yq3HaC2nM3NyfIQNDSdIJ+N2abfxs+6Obbff/y//6DFj8CBC1NJ+iP9jVBP8YpyvtuaOfrW1N/7v4jgaClMQQ9j4Le3qzRvtPmx9Z7uCsQtDTuDNry+fqf9V/PcyQQtDSGoMMLgoYPOs5f//eVk/gIELQ0hqDdyft4Ft+fLf1Y4xV8BwJBS2MKOr0OehWzfxcSp0lyEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJq/j8AY1I4flFcqwAAAABJRU5ErkJggg==" /><!-- -->
In the above graph, dashed lines / empty points represent the best
guesses / truth from the ensemble model, while solid lines / filled
point represent the simulator outputs / observations.</p>
</div>
<div id="fitting-to-synthetic-data" class="section level2">
<h2>Fitting to Synthetic Data</h2>
<p>We now need to convert the observations and simulator outputs into
the required form for <code>EcoEnsemble</code>. This requires that input
columns and rows are named consistently with years and species so that
data from different models can be matched to each other, and missing
data accounted for. We create <code>data frames</code> for each
simulator and assign names.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co">#Create the data frames that we&#39;ll use for EcoEnsemble</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>val_obs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(obs); cov_obs <span class="ot">&lt;-</span> obs.cov</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>val_model_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(models_output[<span class="dv">1</span>,,]); cov_model_1 <span class="ot">&lt;-</span> model.cov[<span class="dv">1</span>,,]</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>val_model_2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(models_output[<span class="dv">2</span>,,]); cov_model_2 <span class="ot">&lt;-</span> model.cov[<span class="dv">2</span>,,]</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>val_model_3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(models_output[<span class="dv">3</span>,,]); cov_model_3 <span class="ot">&lt;-</span> model.cov[<span class="dv">3</span>,,]</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>val_model_4 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(models_output[<span class="dv">4</span>,,]); cov_model_4 <span class="ot">&lt;-</span> model.cov[<span class="dv">4</span>,,]</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#Set the dimnames to ensure EcoEnsemble can identify the information.</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>SPECIES_NAMES <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Species 1&quot;</span>, <span class="st">&quot;Species 2&quot;</span>, <span class="st">&quot;Species 3&quot;</span>)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="fu">dimnames</span>(val_obs) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>Times_obs), SPECIES_NAMES)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="fu">dimnames</span>(val_model_1) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>Time), SPECIES_NAMES)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="fu">dimnames</span>(val_model_2) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>Time), SPECIES_NAMES)</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="fu">dimnames</span>(val_model_3) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>Time), SPECIES_NAMES)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="fu">dimnames</span>(val_model_4) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>Time), SPECIES_NAMES)</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="fu">dimnames</span>(cov_obs) <span class="ot">&lt;-</span> <span class="fu">list</span>(SPECIES_NAMES, SPECIES_NAMES)</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="fu">dimnames</span>(cov_model_1) <span class="ot">&lt;-</span> <span class="fu">list</span>(SPECIES_NAMES, SPECIES_NAMES)</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="fu">dimnames</span>(cov_model_2) <span class="ot">&lt;-</span> <span class="fu">list</span>(SPECIES_NAMES, SPECIES_NAMES)</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="fu">dimnames</span>(cov_model_3) <span class="ot">&lt;-</span> <span class="fu">list</span>(SPECIES_NAMES, SPECIES_NAMES)</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="fu">dimnames</span>(cov_model_4) <span class="ot">&lt;-</span> <span class="fu">list</span>(SPECIES_NAMES, SPECIES_NAMES)</span></code></pre></div>
<p>Now we can fit the ensemble model, this time using vague default
priors.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fit_ensemble_model</span>(<span class="at">observations =</span> <span class="fu">list</span>(val_obs, cov_obs),</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                          <span class="at">simulators =</span> <span class="fu">list</span>(<span class="fu">list</span>(val_model_1, cov_model_1, <span class="st">&quot;Model 1&quot;</span>),</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                                            <span class="fu">list</span>(val_model_2, cov_model_2, <span class="st">&quot;Model 2&quot;</span>),</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                                            <span class="fu">list</span>(val_model_3, cov_model_3, <span class="st">&quot;Model 3&quot;</span>),</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>                                            <span class="fu">list</span>(val_model_4, cov_model_4, <span class="st">&quot;Model 4&quot;</span>)),</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>                          <span class="at">priors =</span> <span class="fu">EnsemblePrior</span>(d),</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>                          <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.9</span>))</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">generate_sample</span>(fit)</span></code></pre></div>
</div>
<div id="results" class="section level2">
<h2>Results</h2>
<p>We can compare the truth as predicted by the ensemble model with the
original truth value.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>var_index <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Year&quot;</span> <span class="ot">=</span> <span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>Time),</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                 <span class="st">&quot;Ensemble&quot;</span> <span class="ot">=</span> <span class="fu">apply</span>(samples<span class="sc">@</span>mle[, var_index, ], <span class="dv">1</span>, median),</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                 <span class="st">&quot;Lower&quot;</span>  <span class="ot">=</span> <span class="fu">apply</span>(samples<span class="sc">@</span>samples[, var_index, ], <span class="dv">1</span>, quantile, <span class="fl">0.1</span>),</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                 <span class="st">&quot;Upper&quot;</span>  <span class="ot">=</span> <span class="fu">apply</span>(samples<span class="sc">@</span>samples[, var_index, ], <span class="dv">1</span>, quantile, <span class="fl">0.9</span>),</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>                 <span class="st">&quot;Actual&quot;</span> <span class="ot">=</span> truth_latent[,var_index])</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>df<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span>Year)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>df <span class="ot">&lt;-</span>  reshape2<span class="sc">::</span><span class="fu">melt</span>(df, <span class="at">id.vars=</span><span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Lower&quot;</span>, <span class="st">&quot;Upper&quot;</span>), <span class="at">variable.name=</span><span class="st">&quot;Simulator&quot;</span>)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co"># We only want uncertainty bands for the Ensemble values, else we set zero width bands </span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>df[df<span class="sc">$</span>Simulator <span class="sc">==</span> <span class="st">&quot;Actual&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Lower&quot;</span>, <span class="st">&quot;Upper&quot;</span>)] <span class="ot">&lt;-</span> df[df<span class="sc">$</span>Simulator <span class="sc">!=</span> <span class="st">&quot;Actual&quot;</span>, <span class="st">&quot;value&quot;</span>]</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">y=</span><span class="st">`</span><span class="at">value</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span><span class="st">`</span><span class="at">Simulator</span><span class="st">`</span>,<span class="at">colour=</span><span class="st">`</span><span class="at">Simulator</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span><span class="st">`</span><span class="at">Lower</span><span class="st">`</span>, <span class="at">ymax =</span><span class="st">`</span><span class="at">Upper</span><span class="st">`</span>, <span class="at">fill =</span> <span class="st">`</span><span class="at">Simulator</span><span class="st">`</span>), <span class="at">alpha=</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we see that the ensemble model is able to effectively capture
the true value.</p>
</div>
<div id="effect-of-number-of-simulators" class="section level2">
<h2>Effect of number of simulators</h2>
<p>Unlike other model averaging methods, the ensemble framework allows
for uncertainty to decrease as the number of models increases. We can
observe this by refitting the ensemble on a smaller number of
simulators. We refit the ensemble with <span class="math inline">\(M =
1, 2, 3\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>fit_M1 <span class="ot">&lt;-</span> <span class="fu">fit_ensemble_model</span>(<span class="at">observations =</span> <span class="fu">list</span>(val_obs, cov_obs),</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>                             <span class="at">simulators =</span> <span class="fu">list</span>(<span class="fu">list</span>(val_model_1, cov_model_1, <span class="st">&quot;Model 1&quot;</span>)),</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>                             <span class="at">priors =</span> <span class="fu">EnsemblePrior</span>(d),</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>                             <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.9</span>))</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>samples_M1 <span class="ot">&lt;-</span> <span class="fu">generate_sample</span>(fit_M1)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>fit_M2 <span class="ot">&lt;-</span> <span class="fu">fit_ensemble_model</span>(<span class="at">observations =</span> <span class="fu">list</span>(val_obs, cov_obs),</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>                             <span class="at">simulators =</span> <span class="fu">list</span>(<span class="fu">list</span>(val_model_1, cov_model_1, <span class="st">&quot;Model 1&quot;</span>),</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>                                            <span class="fu">list</span>(val_model_2, cov_model_2, <span class="st">&quot;Model 2&quot;</span>)),</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>                          <span class="at">priors =</span> <span class="fu">EnsemblePrior</span>(d),</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>                          <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.9</span>))</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>samples_M2 <span class="ot">&lt;-</span> <span class="fu">generate_sample</span>(fit_M2)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>fit_M3 <span class="ot">&lt;-</span> <span class="fu">fit_ensemble_model</span>(<span class="at">observations =</span> <span class="fu">list</span>(val_obs, cov_obs),</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>                          <span class="at">simulators =</span> <span class="fu">list</span>(<span class="fu">list</span>(val_model_1, cov_model_1, <span class="st">&quot;Model 1&quot;</span>),</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>                                            <span class="fu">list</span>(val_model_2, cov_model_2, <span class="st">&quot;Model 2&quot;</span>),</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>                                            <span class="fu">list</span>(val_model_3, cov_model_3, <span class="st">&quot;Model 3&quot;</span>)),</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>                          <span class="at">priors =</span> <span class="fu">EnsemblePrior</span>(d),</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>                          <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.9</span>))</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>samples_M3 <span class="ot">&lt;-</span> <span class="fu">generate_sample</span>(fit_M3)</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="fu">plot_grid</span>(</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>  <span class="fu">plot</span>(samples_M1, <span class="at">variable=</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;1 Model&quot;</span>)  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>),</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>  <span class="fu">plot</span>(samples_M2, <span class="at">variable=</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;2 Models&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>),</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>  <span class="fu">plot</span>(samples_M3, <span class="at">variable=</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;3 Models&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>),</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>  <span class="fu">plot</span>(samples   , <span class="at">variable=</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;4 Models&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>To quantify this effect, we plot how the variance of predictions
beyond the range of observation data changes over time.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>def.par <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly=</span><span class="cn">TRUE</span>) <span class="co">#old pars</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(d, <span class="dv">1</span>))</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>legend_ys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.18</span>, <span class="fl">0.12</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="fu">plot.ts</span>(<span class="fu">apply</span>(samples_M1<span class="sc">@</span>samples[<span class="dv">40</span><span class="sc">:</span><span class="dv">50</span>,i,],<span class="dv">1</span>, var), </span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>          <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Species &quot;</span>, i), <span class="at">ylab=</span><span class="st">&quot;Variance&quot;</span> )</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">apply</span>(samples_M2<span class="sc">@</span>samples[<span class="dv">40</span><span class="sc">:</span><span class="dv">50</span>,i,],<span class="dv">1</span>, var), <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">apply</span>(samples_M3<span class="sc">@</span>samples[<span class="dv">40</span><span class="sc">:</span><span class="dv">50</span>,i,],<span class="dv">1</span>, var), <span class="at">col =</span> <span class="dv">3</span>)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">apply</span>(samples<span class="sc">@</span>samples[<span class="dv">40</span><span class="sc">:</span><span class="dv">50</span>,i,],<span class="dv">1</span>, var), <span class="at">col =</span> <span class="dv">4</span>)</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="dv">1</span>, legend_ys[i], <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;1 Model&quot;</span>, <span class="st">&quot;2 Models&quot;</span>, <span class="st">&quot;3 Models&quot;</span>, <span class="st">&quot;4 Models&quot;</span>),</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>          <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>}</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="fu">par</span>(def.par)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As shown in the graphs, there is a marked reduction in the variance
of predictions when more simulators are used in the ensemble.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
